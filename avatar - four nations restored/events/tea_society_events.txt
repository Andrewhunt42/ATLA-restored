namespace = TEA

character_event = {
    id = TEA.1
	hide_window = yes
    is_triggered_only = yes
    trigger = {
    	FROM = { leader = { society_member_of = tea_enthusiasts } }
    }
    immediate = {
    	FROM = { leader = { character_event = { id = TEA.2 } } }
    }
}

#Ping event
character_event = {
    id = TEA.2
	hide_window = yes
    is_triggered_only = yes
    immediate = {
    	FROM = { letter_event = { id = TEA.3 } }
    }
}

#Welcome letter
letter_event = {
    id = TEA.3
    desc = tea_enthusiasts_welcome_letter
    border = GFX_event_letter_frame_diplomacy

    is_triggered_only = yes

	immediate = {
		set_character_flag = society_join_block
	}

    option = {
        name = tea_enthusiasts_welcome_letter_option
		join_society = tea_enthusiasts
		clr_character_flag = society_join_block
    }
}

#Choose Self or Spirit event.
narrative_event = {
	id = TEA.4
	title = choose_self_or_spirit_title
	desc = choose_self_or_spirit_desc
	border = GFX_event_narrative_frame_diplomacy
	is_triggered_only = yes
	
	trigger = { 
		society_member_of = tea_enthusiasts
		society_rank >= 2
		NOT = { days_in_society == 0 }
		NOT = { has_character_flag = tea_chose_self }
		NOT = { has_character_flag = tea_chose_spirits }
	}	
	
	option = {
		name = choose_self
		custom_tooltip = {
			text = choose_self_tooltip
			set_character_flag = tea_chose_self
		}
	}
	
	option = {
		name = choose_spirits
		custom_tooltip = {
			text = choose_spirits_tooltip
			set_character_flag = tea_chose_spirits
		}
	}
}

character_event = {
	id = TEA.10
	desc = tea_remove_envious_and_wroth_event
	border = GFX_event_normal_frame_diplomacy

	is_in_society = yes
	only_capable = yes
	
	trigger = {
		society_member_of = tea_enthusiasts
		OR = {
			trait = envious
			trait = wroth
		}
	}
	
	mean_time_to_happen = {
		months = 300
		
		modifier = {
			factor = 0.5
			diplomacy = 12
		}
		modifier = {
			factor = 0.5
			diplomacy = 14
		}
		modifier = {
			factor = 0.25
			age = 50
		}	
	}
	
	option = {
		name = tea_remove_envious_and_wroth_event_option_1
		trigger = {
			trait = envious
		}
		remove_trait = envious
	}
	
	option = {
		name = tea_remove_envious_and_wroth_event_option_2
		trigger = {
			trait = wroth
		}
		remove_trait = wroth
	}
}

character_event = {
	id = TEA.11
	desc = tea_remove_stressed
	border = GFX_event_normal_frame_diplomacy

	is_in_society = yes
	only_capable = yes
	
	trigger = {
		society_member_of = tea_enthusiasts
		trait = stressed
	}
	
	mean_time_to_happen = {
		months = 200
		
		modifier = {
			factor = 0.5
			diplomacy = 12
		}
		modifier = {
			factor = 0.5
			diplomacy = 14
		}
		modifier = {
			factor = 0.25
			age = 50
		}
	}
	
	option = {
		name = tea_remove_stressed_option
		remove_trait = stressed
	}
}

character_event = {
	id = TEA.12
	desc = tea_add_diplomacy
	border = GFX_event_normal_frame_diplomacy

	is_in_society = yes
	only_capable = yes
	
	trigger = {
		society_member_of = tea_enthusiasts
		NOT = { diplomacy = 16 }
	}
	
	mean_time_to_happen = {
		months = 1000
		
		modifier = {
			factor = 0.75
			NOT = { diplomacy = 12 }
		}
		modifier = {
			factor = 0.75
			NOT = { diplomacy = 14 }
		}
		modifier = {
			factor = 0.75
			age = 50
		}
	}
	
	option = {
		name = tea_add_diplomacy_option
		change_diplomacy = 1
	}
}
#100 -> DECISION EVENTS
#Share Tea
letter_event = {
	id = TEA.100
	is_triggered_only = yes
	desc = share_tea_letter_event
	
	option = {
		desc = share_tea_letter_event_accept
		hidden_tooltip = {
			clr_character_flag = removed_negative_trait
			if = {
				limit = {
					OR = {
						trait = wroth
						trait = stressed
					}
				}
				set_character_flag = removed_negative_trait
				remove_trait = wroth
				remove_trait = stressed
			}
		}
		
		opinion = {
			modifier = opinion_improved_relations
			who = event_target:tea_friend
			years = 2
		}

		custom_tooltip = {
			text = can_make_into_friend
			hidden_tooltip = {
				random_list = {
					90 = {}
					10 = {
						modifier = { has_character_flag = removed_negative_trait factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_remove_negative_trait } factor = 3 }
						modifier = { event_target:tea_friend = { trait = tea_master } factor = 3 }
						save_event_target_as = helped_tea_friend
						event_target:tea_friend = { letter_event = { id = TEA.110 days = 3 } }
					}
				}
			}
		}
		
		if = {
			limit = {
				has_character_flag = removed_negative_trait
				event_target:tea_friend = { has_quest = quest_remove_negative_trait }
			}
			event_target:tea_friend = { character_event = { id = TEA.1101 } }
		}
	}
	
	option = {
		desc = share_tea_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

#Brew Enlightening Tea
letter_event = {
	id = TEA.101
	is_triggered_only = yes
	desc = share_tea_letter_event
	
	option = {
		desc = share_tea_letter_event_accept
		custom_tooltip = {
			text = enlightening_tea_tooltip
			hidden_tooltip = {
				clr_character_flag = removed_negative_trait
				if = {
					limit = {
						OR = {
							trait = wroth
							trait = envious
						}
					}
					set_character_flag = removed_negative_trait
					remove_trait = wroth
					remove_trait = envious
				} else = {
					set_character_flag = add_kind
					add_trait = kind
				}
			}
		}
		
		opinion = {
			modifier = opinion_improved_relations
			who = event_target:tea_friend
			years = 2
		}

		custom_tooltip = {
			text = can_make_into_friend
			hidden_tooltip = {
				random_list = {
					90 = {}
					10 = {
						modifier = { has_character_flag = removed_negative_trait factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_remove_negative_trait } factor = 3 }
						modifier = { event_target:tea_friend = { trait = tea_master } factor = 3 }
						save_event_target_as = helped_tea_friend
						event_target:tea_friend = { letter_event = { id = TEA.110 days = 3 } }
					}
				}
			}
		}
		
		if = {
			limit = {
				has_character_flag = removed_negative_trait
				event_target:tea_friend = { has_quest = quest_remove_negative_trait }
			}
			event_target:tea_friend = { character_event = { id = TEA.1101 } }
		}
		
		if = {
			limit = {
				has_character_flag = add_kind
				event_target:tea_friend = { has_quest = quest_teach_kindness }
			}
			event_target:tea_friend = { character_event = { id = TEA.1103 } }
		}
	}
	
	option = {
		desc = share_tea_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

#Brew Spiritual Tea
letter_event = {
	id = TEA.102
	is_triggered_only = yes
	desc = share_tea_letter_event
	
	option = {
		desc = share_tea_letter_event_accept
		hidden_tooltip = {
			clr_character_flag = removed_negative_trait
			if = {
				limit = {
					OR = {
						trait = insane
						trait = possessed
						trait = depressed
					}
				}
				set_character_flag = removed_negative_trait

			}
		}
		remove_trait = insane
		remove_trait = possessed
		remove_trait = depressed		
		opinion = {
			modifier = opinion_improved_relations
			who = event_target:tea_friend
			years = 2
		}

		custom_tooltip = {
			text = can_make_into_friend
			hidden_tooltip = {
				random_list = {
					90 = {}
					10 = {
						modifier = { has_character_flag = removed_negative_trait factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_remove_negative_trait } factor = 3 }
						modifier = { event_target:tea_friend = { trait = tea_master } factor = 3 }
						save_event_target_as = helped_tea_friend
						event_target:tea_friend = { letter_event = { id = TEA.110 days = 3 } }
					}
				}
			}
		}
		
		if = {
			limit = {
				has_character_flag = removed_negative_trait
				event_target:tea_friend = { has_quest = quest_remove_negative_trait }
			}
			event_target:tea_friend = { character_event = { id = TEA.1101 } }
		}
	}
	
	option = {
		desc = share_tea_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

letter_event = {
	id = TEA.103
	is_triggered_only = yes
	desc = educate_letter_event
	
	option = {
		desc = educate_letter_event_accept
		custom_tooltip = {
			text = improve_education
			hidden_tooltip = {
				trigger_switch = {
					on_trigger = trait
					detached_priest = {
						set_character_flag = lowest_level_upgrade
						remove_trait = detached_priest
						add_trait = martial_cleric
					}
					martial_cleric = {
						remove_trait = martial_cleric
						add_trait = scholarly_theologian
					}
					scholarly_theologian = {
						remove_trait = scholarly_theologian
						add_trait = mastermind_theologian
					}
					misguided_warrior = {
						set_character_flag = lowest_level_upgrade
						remove_trait = misguided_warrior
						add_trait = tough_soldier
					}
					tough_soldier = {
						remove_trait = tough_soldier
						add_trait = skilled_tactician
					}
					skilled_tactician = {
						remove_trait = skilled_tactician
						add_trait = brilliant_strategist
					}
					indulgent_wastrel = {
						set_character_flag = lowest_level_upgrade
						remove_trait = indulgent_wastrel
						add_trait = thrifty_clerk
					}
					thrifty_clerk = {
						remove_trait = thrifty_clerk
						add_trait = fortune_builder
					}
					fortune_builder = {
						remove_trait = fortune_builder
						add_trait = midas_touched
					}
					naive_appeaser = {
						set_character_flag = lowest_level_upgrade
						remove_trait = naive_appeaser
						add_trait = underhanded_rogue
					}
					underhanded_rogue = {
						remove_trait = underhanded_rogue
						add_trait = charismatic_negotiator
					}
					charismatic_negotiator = {
						remove_trait = charismatic_negotiator
						add_trait = grey_eminence
					}
					amateurish_plotter = {
						remove_trait = amateurish_plotter
						add_trait = flamboyant_schemer
					}		
					flamboyant_schemer = {
						remove_trait = flamboyant_schemer
						add_trait = intricate_webweaver
					}
					intricate_webweaver = {
						remove_trait = intricate_webweaver
						add_trait = elusive_shadow
					}
				}
			}
		}
		if = {
			limit = {
				has_character_flag = lowest_level_upgrade
				event_target:tea_friend = { has_quest = quest_educate }
			}
			event_target:tea_friend = { character_event = { id = TEA.1104 } }
		}
	}
	
	option = {
		desc = educate_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

#Brew Herbal Tea
letter_event = {
	id = TEA.104
	is_triggered_only = yes
	desc = share_tea_letter_event
	option = {
		desc = share_tea_letter_event_accept
		hidden_tooltip = {
			clr_character_flag = removed_negative_trait
			if = {
				limit = {
					poorly_treated_for_disease_trigger = yes
				}
				set_character_flag = removed_negative_trait		
			}
		}
		
		remove_character_modifier = failed_treatment_1
		remove_character_modifier = failed_treatment_2
		remove_character_modifier = mystic_treatment_poor
		remove_character_modifier = mystic_treatment_terrible
		
		add_character_modifier = {
			name = had_herbal_tea
			days = 730
		}

		opinion = {
			modifier = opinion_improved_relations
			who = event_target:tea_friend
			years = 2
		}

		custom_tooltip = {
			text = can_make_into_friend
			hidden_tooltip = {
				random_list = {
					90 = {}
					10 = {
						modifier = { has_character_flag = removed_negative_trait factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_remove_negative_trait } factor = 3 }
						modifier = { event_target:tea_friend = { trait = tea_master } factor = 3 }
						save_event_target_as = helped_tea_friend
						event_target:tea_friend = { letter_event = { id = TEA.110 days = 3 } }
					}
				}
			}
		}
		
		if = {
			limit = {
				has_character_flag = removed_negative_trait
				event_target:tea_friend = { has_quest = quest_remove_negative_trait }
			}
			event_target:tea_friend = { character_event = { id = TEA.1101 } }
		}
	}
	
	option = {
		desc = share_tea_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

letter_event = {
	id = TEA.105
	is_triggered_only = yes
	desc = improve_bending_letter_event
	
	option = {
		desc = improve_bending_event_accept
		custom_tooltip = {
			text = improve_bending_tea
			hidden_tooltip = {
				trigger_switch = {
					on_trigger = trait
					incompetent_bender = {
						remove_trait = incompetent_bender
						add_trait = competent_bender
					}
					competent_bender = {
						remove_trait = competent_bender
						add_trait = powerful_bender
					}
					powerful_bender = {
						remove_trait = powerful_bender
						add_trait = master_bender
					}
				}
			}
		}
		
		opinion = {
			modifier = opinion_improved_relations
			who = event_target:tea_friend
			years = 2
		}

		custom_tooltip = {
			text = can_make_into_friend
			hidden_tooltip = {
				random_list = {
					90 = {}
					10 = {
						modifier = { has_character_flag = removed_negative_trait factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_remove_negative_trait } factor = 3 }
						modifier = { event_target:tea_friend = { trait = tea_master } factor = 3 }
						save_event_target_as = helped_tea_friend
						event_target:tea_friend = { letter_event = { id = TEA.110 days = 3 } }
					}
				}
			}
		}
	}
	
	option = {
		desc = educate_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

#Become friends after sharing tea!
letter_event = {
	id = TEA.110
	is_triggered_only = yes
	desc = share_tea_letter_friend_event
	
	option = {
		name = share_tea_letter_friend_event_option
		add_friend = event_target:helped_tea_friend
	}
}

# 1000 : QUEST EVENTS
character_event = {
	id = TEA.1000
	hide_window = yes

	is_triggered_only = yes
	is_in_society = yes
	only_capable = yes

	trigger = {
		is_society_grandmaster = no
		has_any_quest = no
		NOT = { is_inaccessible_trigger = yes }
		NOT = { has_character_modifier = quest_cooldown_timer }	
	}

	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		grandmaster = { character_event = { id = TEA.2000 } }	
	}
}

#toombla
character_event = {
	id = TEA.2000
	hide_window = yes

	is_triggered_only = yes
	is_in_society = yes
	only_capable = yes
	
	immediate = {
		FROM = {
			random_list = {
				10 = { # Share Tea
					modifier = {
						factor = 2
						society_rank == 1
					}				
					character_event = { id = TEA.1001 }
				}
				10 = { # Rest for an Afternoon
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_self }
					}
					modifier = {
						factor = 0
						OR = {
							AND = {
								society_rank == 2
								OR = {
									trait = underhanded_rogue
									trait = charismatic_negotiator
									trait = grey_eminence
								}
							}
							AND = {
								society_rank == 3
								OR = {
									trait = charismatic_negotiator
									trait = grey_eminence
								}
							}
							AND = {
								society_rank == 4
								trait = grey_eminence
							}
						}
					}
					character_event = { id = TEA.1002 }
				}
				10 = { # Teach Kindness
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_self }
					}
					
					character_event = { id = TEA.1003 }
				}
				10 = { # Educate Someone in Need
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_self }
					}
					modifier = {
						factor = 0
						society_rank < 3
					}	
					character_event = { id = TEA.1004 }
				}
				10 = { # Take the Family Focus
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_self }
					}
					modifier = {
						factor = 10
						NOT = { has_focus = focus_family }
					}
					character_event = { id = TEA.1005 }
				}
			}
		}
	}
}

#Share Tea with Someone in Pain
society_quest_event = {
	id = TEA.1001
	desc = quest_remove_negative_trait_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_remove_negative_trait
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1101

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1201 } }	
	}
}

character_event = {
	id = TEA.1201
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1301 } }
	}
}

letter_event = {
	id = TEA.1301
	desc = quest_remove_negative_trait_event_success
	border = GFX_event_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = quest_remove_negative_trait_event_success_option
		clr_quest = quest_remove_negative_trait
		change_society_currency = 200
	}
}

#Relaxing Afternoon
society_quest_event = {
	id = TEA.1002
	desc = quest_relaxing_afternoon_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_relaxing_afternoon
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1102

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1202 } }	
	}
}

character_event = {
	id = TEA.1202
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1302 } }
	}
}

letter_event = {
	id = TEA.1302
	desc = quest_relaxing_afternoon_success
	border = GFX_event_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = quest_relaxing_afternoon_success_option
		clr_quest = quest_relaxing_afternoon
		change_society_currency = 100
		clr_character_flag = relaxing_afternoon
	}
}

#Teach Kindness
society_quest_event = {
	id = TEA.1003
	desc = quest_teach_kindness_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_teach_kindness
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1103

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1203 } }	
	}
}

character_event = {
	id = TEA.1203
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1303 } }
	}
}

letter_event = {
	id = TEA.1303
	desc = quest_teach_kindness_success
	border = GFX_event_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = quest_teach_kindness_success_option
		clr_quest = quest_teach_kindness
		change_society_currency = 200
	}
}

#Educate Someone in Need
society_quest_event = {
	id = TEA.1004
	desc = quest_educate_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_teach_kindness
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1104

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1204 } }	
	}
}

character_event = {
	id = TEA.1204
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1304 } }
	}
}

letter_event = {
	id = TEA.1304
	desc = quest_educate_success
	border = GFX_event_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = quest_educate_success_option
		clr_quest = quest_educate
		change_society_currency = 100
	}
}

#Take the Family Focus
society_quest_event = {
	id = TEA.1005
	desc = quest_family_focus_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_family_focus
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1105

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1205 } }	
	}
}

character_event = {
	id = TEA.1205
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1305 } }
	}
}

letter_event = {
	id = TEA.1305
	desc = quest_family_focus_success
	border = GFX_event_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = quest_family_focus_success_option
		clr_quest = quest_take_family_focus
		change_society_currency = 100
	}
}

# society_quest_event = {
	# id = TEA.1003
	# desc = quest_family_focus_event
	# border = GFX_event_letter_frame_diplomacy

	# is_triggered_only = yes

	# option = {
		# name = ACCEPT
		# set_quest = quest_family_focus
	# }
	# option = {
		# name = DECLINE
		# custom_tooltip = { text = decline_quest_tooltip }

		# add_character_modifier = {
			# name = quest_cooldown_timer
			# hidden = yes
			# days = 1000
		# }

		# ai_chance = { factor = 0 }
	# }
# }

# society_quest_event = {
	# id = TEA.1004
	# desc = quest_build_tea_shop_event
	# border = GFX_event_letter_frame_diplomacy

	# is_triggered_only = yes

	# option = {
		# name = ACCEPT
		# set_quest = quest_build_tea_shop
	# }
	# option = {
		# name = DECLINE
		# custom_tooltip = { text = decline_quest_tooltip }

		# add_character_modifier = {
			# name = quest_cooldown_timer
			# hidden = yes
			# days = 1000
		# }

		# ai_chance = { factor = 0 }
	# }
# }

# society_quest_event = {
	# id = TEA.1005
	# desc = quest_have_a_cup_of_tea_event
	# border = GFX_event_letter_frame_diplomacy

	# is_triggered_only = yes

	# option = {
		# name = ACCEPT
		# set_quest = quest_have_a_cup_of_tea
	# }
	# option = {
		# name = DECLINE
		# custom_tooltip = { text = decline_quest_tooltip }

		# add_character_modifier = {
			# name = quest_cooldown_timer
			# hidden = yes
			# days = 1000
		# }

		# ai_chance = { factor = 0 }
	# }
# }

# DECISION EVENTS
character_event = {
	id = TEA.10000
	desc = relaxing_afternoon_event
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes

	option = {
		name = relaxing_afternoon_event_get_diplo_education
		trigger = {
			NOR = {
				trait = naive_appeaser
				trait = underhanded_rogue
				trait = charismatic_negotiator
				trait = grey_eminence			
			}
		}
	
		name = relaxing_afternoon_event_get_diplo_education
		custom_tooltip = {
			text = relaxing_afternoon_replace_with_diplo
			hidden_tooltip = {
				character_event = { id = TEA.10010 }
			}
		}
		add_trait = underhanded_rogue
		character_event = { id = TEA.1102 }
	}
	
	option = {
		name = relaxing_afternoon_event_improve_diplo_education
		trigger = {
			OR = {
				trait = naive_appeaser
				trait = underhanded_rogue
				trait = charismatic_negotiator
			}
		}	
		trigger_switch = {
			on_trigger = trait
			naive_appeaser = {
				remove_trait = naive_appeaser
				add_trait = underhanded_rogue
			}
			underhanded_rogue = {
				remove_trait = underhanded_rogue
				add_trait = charismatic_negotiator
			}
			charismatic_negotiator = {
				remove_trait = charismatic_negotiator
				add_trait = grey_eminence
			}
		}
		character_event = { id = TEA.1102 }
	}
	
	option = {
		name = relaxing_afternoon_event_improve_learning_education
		trigger = {
			OR = {
				trait = detached_priest
				trait = martial_cleric
				trait = scholarly_theologian
			}
		}
		
		random_list = {
			25 = {}
			75 = {
				trigger_switch = {
					on_trigger = trait
					detached_priest = {
						remove_trait = detached_priest
						add_trait = martial_cleric
					}
					martial_cleric = {
						remove_trait = martial_cleric
						add_trait = scholarly_theologian
					}
					scholarly_theologian = {
						remove_trait = scholarly_theologian
						add_trait = mastermind_theologian
					}
				}
			}
		}
		character_event = { id = TEA.1102 }
	}

	option = {
		name = relaxing_afternoon_event_improve_stewardship_education
		trigger = {
			OR = {
				trait = indulgent_wastrel
				trait = thrifty_clerk
				trait = fortune_builder
			}
		}
		
		random_list = {
			75 = {}
			25 = {
				trigger_switch = {
					on_trigger = trait
					indulgent_wastrel = {
						remove_trait = indulgent_wastrel
						add_trait = thrifty_clerk
					}
					thrifty_clerk = {
						remove_trait = thrifty_clerk
						add_trait = fortune_builder
					}
					fortune_builder = {
						remove_trait = fortune_builder
						add_trait = midas_touched
					}
				}
			}
		}
		character_event = { id = TEA.1102 }
	}
	
	option = {
		name = relaxing_afternoon_event_no_change
		character_event = { id = TEA.1102 }
	}
}

character_event = {
	id = TEA.10010
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		remove_trait = amateurish_plotter
		remove_trait = flamboyant_schemer
		remove_trait = intricate_webweaver
		remove_trait = elusive_shadow
		remove_trait = naive_appeaser
		remove_trait = underhanded_rogue
		remove_trait = charismatic_negotiator
		remove_trait = grey_eminence
		remove_trait = indulgent_wastrel
		remove_trait = thrifty_clerk
		remove_trait = fortune_builder
		remove_trait = midas_touched
		remove_trait = misguided_warrior
		remove_trait = tough_soldier
		remove_trait = skilled_tactician
		remove_trait = brilliant_strategist
		remove_trait = detached_priest
		remove_trait = martial_cleric
		remove_trait = scholarly_theologian
		remove_trait = mastermind_theologian
	}
}

character_event = {
	id = TEA.10001
	desc = tea_build_plantation_1
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_1_option
		remove_trait = stressed
		capital_holding = {
			add_building = tea_plantation_1
		}
		custom_tooltip = {
			text = can_build_tea_shop_1
		}
	}
}