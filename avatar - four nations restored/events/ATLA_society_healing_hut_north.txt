# Society Events
namespace = MNHHN

# Hidden start: Send the rank-up request to the current Grandmaster (delayed event on self, from decision to rank up)
character_event = {
	id = MNHHN.3000

	hide_window = yes

	trigger = {
		has_character_flag = has_sent_request_to_rank_up
	}
	
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { is_in_society = yes }
			random_society_member = {
				limit = {
					is_society_grandmaster = yes
					same_society_as = ROOT
				}
				character_event = { id = MNHHN.3001 } # send request to Grand Master. Relic rewards also handled by this event
			}
		}
		if = {
			limit = { is_in_society = no }
			clr_character_flag = has_sent_request_to_rank_up
		}
	}
}

# Grandmaster gets the rank-up request
character_event = {
	id = MNHHN.3001
	
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		event_target:rank_up_target = { letter_event = { id = MNHHN.3002 } }
	}
}

#Grand master approves my request
letter_event = {
	id = MNHHN.3002
	desc = EVTDESC_MNM_10001_A
	border = GFX_event_letter_frame_intrigue

	trigger = {
		society_rank < 4
		has_character_flag = has_sent_request_to_rank_up
	}
	
	is_triggered_only = yes

	#Yes
	option = {
		name = {
			text = EVTOPTA_10001
		}
		if = { limit = { society_rank < 4 } #Reminder: Remember you can rankup to 4 in some societies
			society_rank_up = 1
		}
		clr_character_flag = has_sent_request_to_rank_up
	}
}

#Grand master approves my request
letter_event = {
	id = MNHHN.3002
	desc = EVTDESC_MNM_10001_A
	border = GFX_event_letter_frame_intrigue

	trigger = {
		society_rank < 4
		has_character_flag = has_sent_request_to_rank_up
	}
	
	is_triggered_only = yes

	#Yes
	option = {
		name = {
			text = EVTOPTA_10001
		}
		if = { limit = { society_rank < 4 } #Reminder: Remember you can rankup to 4 in some societies
			society_rank_up = 1
		}
		clr_character_flag = has_sent_request_to_rank_up
	}
}

# Force join AI characters to societies
character_event = {
	id = MNHHN.3050
	hide_window = yes
	
	only_rulers = yes
	is_triggered_only = yes
	
	has_dlc = "Mystics"
	
	immediate = {
		if = {
			limit = {
				ai = yes
				prisoner = no
				NOT = { trait = incapable }
				is_in_society = yes
				society_rank < 3
				society_can_rank_up = yes
			}
			random_list = {
				75 = {}
				25 = {
					society_rank_up = 1					
				}
			}
		}
		if = {
			limit = {
				ai = yes
				prisoner = no
				NOT = { trait = incapable }
				is_adult = yes
				is_in_society = no
				controls_religion = no
				block_general_event_trigger = no
			}
			character_event = { id = MNHHN.3050 }
		}
		any_courtier = {
			limit = {
				ai = yes
				prisoner = no
				NOT = { trait = incapable }
				is_in_society = yes
				society_rank < 3
				society_can_rank_up = yes
			}
			random_list = {
				75 = {}
				25 = {
					society_rank_up = 1					
				}
			}
		}
		any_courtier = {
			limit = {
				ai = yes
				prisoner = no
				NOT = { trait = incapable }
				is_adult = yes
				is_in_society = no
				controls_religion = no
				block_general_event_trigger = no
			}
			character_event = { id = MNHHN.3050 }
		}
	}
}

character_event = {
	id = MNM.10031
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			95 = { # do nothing
			}
			5 = { # try to join a society
				modifier = {
					factor = 2
					higher_tier_than = BARON
				}
				modifier = {
					factor = 3
					true_religion = shiite
					can_join_society = the_assassins
				}
				
				random_list = {
					700 = { } # Fall back dead weight
					100 = {
						trigger = {
							can_join_society = monastic_order_benedictine
						}
						modifier = {
							factor = 3
							OR = {
								trait = zealous
								trait = scholar
								trait = theologian
								trait = gardener
								trait = monk
								trait = nun
								learning = 16
								is_priest = yes
							}
						}
						modifier = {
							factor = 2
							monastic_order_benedictine = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							monastic_order_benedictine = { num_of_society_members < 10 }
						}
						join_society = monastic_order_benedictine
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					100 = {
						trigger = {
							can_join_society = monastic_order_dominican
						}
						modifier = {
							factor = 3
							OR = {
								trait = zealous
								trait = scholar
								trait = theologian
								trait = gardener
								trait = monk
								trait = nun
								learning = 16
								is_priest = yes
							}
						}
						modifier = {
							factor = 2
							monastic_order_dominican = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							monastic_order_dominican = { num_of_society_members < 10 }
						}
						join_society = monastic_order_dominican
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
								}
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					100 = {
						trigger = {
							can_join_society = monastic_order_orthodox
						}
						modifier = {
							factor = 3
							OR = {
								trait = zealous
								trait = scholar
								trait = theologian
								trait = gardener
								trait = monk
								trait = nun
								learning = 16
								is_priest = yes
							}
						}
						modifier = {
							factor = 2
							monastic_order_orthodox = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							monastic_order_orthodox = { num_of_society_members < 10 }
						}
						join_society = monastic_order_orthodox
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					100 = {
						trigger = {
							can_join_society = monastic_order_nestorian
						}
						modifier = {
							factor = 3
							OR = {
								trait = zealous
								trait = scholar
								trait = theologian
								trait = gardener
								trait = monk
								trait = nun
								learning = 16
								is_priest = yes
							}
						}
						modifier = {
							factor = 2
							monastic_order_nestorian = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							monastic_order_nestorian = { num_of_society_members < 10 }
						}
						join_society = monastic_order_nestorian
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					100 = {
						trigger = {
							can_join_society = monastic_order_monophysite
						}
						modifier = {
							factor = 3
							OR = {
								trait = zealous
								trait = scholar
								trait = theologian
								trait = gardener
								trait = monk
								trait = nun
								learning = 16
								is_priest = yes
							}
						}
						modifier = {
							factor = 2
							monastic_order_monophysite = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							monastic_order_monophysite = { num_of_society_members < 10 }
						}
						join_society = monastic_order_monophysite
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					100 = {
						trigger = {
							can_join_society = monastic_order_hindu
						}
						modifier = {
							factor = 3
							OR = {
								trait = zealous
								trait = scholar
								trait = theologian
								trait = brahmin
								learning = 16
								is_priest = yes
							}
						}
						modifier = {
							factor = 2
							monastic_order_hindu = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							monastic_order_hindu = { num_of_society_members < 10 }
						}
						join_society = monastic_order_hindu
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					100 = {
						trigger = {
							can_join_society = monastic_order_buddhist
						}
						modifier = {
							factor = 3
							OR = {
								trait = zealous
								trait = scholar
								trait = theologian
								trait = brahmin
								learning = 16
								is_priest = yes
							}
						}
						modifier = {
							factor = 2
							monastic_order_buddhist = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							monastic_order_buddhist = { num_of_society_members < 10 }
						}
						join_society = monastic_order_buddhist
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					100 = {
						trigger = {
							can_join_society = monastic_order_jain
						}
						modifier = {
							factor = 3
							OR = {
								trait = zealous
								trait = scholar
								trait = theologian
								trait = brahmin
								learning = 16
								is_priest = yes
							}
						}
						modifier = {
							factor = 2
							monastic_order_jain = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							monastic_order_jain = { num_of_society_members < 10 }
						}
						join_society = monastic_order_jain
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					100 = {
						trigger = {
							can_join_society = monastic_order_stoics
						}
						modifier = {
							factor = 3
							OR = {
								trait = erudite
								trait = scholar
								trait = theologian
								trait = diligent
								learning = 16
							}
						}
						modifier = {
							factor = 2
							monastic_order_stoics = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							monastic_order_stoics = { num_of_society_members < 10 }
						}
						join_society = monastic_order_stoics
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_catholic
						}
						join_society = secret_religious_society_catholic
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_orthodox
						}
						join_society = secret_religious_society_orthodox
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_sunni
						}
						join_society = secret_religious_society_sunni
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_shiite
						}
						join_society = secret_religious_society_shiite
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_jewish
						}
						join_society = secret_religious_society_jewish
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_zoroastrian
						}
						join_society = secret_religious_society_zoroastrian
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_hindu
						}
						join_society = secret_religious_society_hindu
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_buddhist
						}
						join_society = secret_religious_society_buddhist
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_jain
						}
						join_society = secret_religious_society_jain
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_norse_pagan_reformed
						}
						join_society = secret_religious_society_norse_pagan_reformed
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_slavic_pagan_reformed
						}
						join_society = secret_religious_society_slavic_pagan_reformed
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_tengri_pagan_reformed
						}
						join_society = secret_religious_society_tengri_pagan_reformed
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_baltic_pagan_reformed
						}
						join_society = secret_religious_society_baltic_pagan_reformed
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_finnish_pagan_reformed
						}
						join_society = secret_religious_society_finnish_pagan_reformed
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_west_african_pagan_reformed
						}
						join_society = secret_religious_society_west_african_pagan_reformed
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_zun_pagan_reformed
						}
						join_society = secret_religious_society_zun_pagan_reformed
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_bon_reformed
						}
						join_society = secret_religious_society_bon_reformed
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_hellenic_pagan_reformed
						}
						join_society = secret_religious_society_hellenic_pagan_reformed
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					200 = {
						trigger = {
							can_join_society = secret_religious_society_hellenic_pagan
						}
						join_society = secret_religious_society_hellenic_pagan
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					150 = {
						trigger = {
							can_join_society = hermetics
						}
						modifier = {
							factor = 5
							is_dumb_trigger = no
							OR = { 
								learning = 12
								trait = scholar
								trait = erudite
								trait = genius
								trait = mystic
							}
						}
						modifier = {
							factor = 0
							is_landed = no
						}
						join_society = hermetics
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					500 = { 
						trigger = {
							can_join_society = the_assassins
						}
						modifier = {
							factor = 0.5
							is_landed = no
						}
						modifier = {
							factor = 0.1
							NOR = { 
								true_religion = shiite 
								AND = {
									trait = sympathy_islam
									trait = deceitful
									NOT = { trait = zealous }
									OR = {
										trait = schemer
										trait = elusive_shadow
										intrigue = 18
									}
								}
							}
						}
						modifier = {
							factor = 0
							NOT = { true_religion = shiite }
							trait = zealous
						}
						modifier = {
							factor = 0
							NOT = { intrigue = 6 }
						}
						modifier = {
							factor = 2
							true_religion = shiite
							is_landed = yes
						}
						modifier = {
							factor = 5
							true_religion = shiite
							NOT = { trait = decadent }
							OR = {
								trait = zealous
								trait = schemer
								trait = elusive_shadow
								trait = deceitful
								trait = ambitious
								intrigue = 18
							}
						}
						modifier = {
							factor = 2
							the_assassins = { num_of_society_members < 20 }
						}
						modifier = {
							factor = 2
							the_assassins = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							the_assassins = { num_of_society_members < 10 }
						}
						if = {
							limit = {
								NOT = {
									religion = shiite
								}
							}
							set_secret_religion = shiite
						}
						join_society = the_assassins
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					50 = { 
						trigger = {
							can_join_society = the_satanists
						}
						modifier = {
							factor = 5
							OR = {
								has_impious_trait_trigger = yes
								has_vice_trigger = yes
								trait = drunkard
								trait = possessed
								trait = lunatic
							}
						}
						modifier = {
							factor = 2
							the_satanists = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							the_satanists = { num_of_society_members < 10 }
						}
						join_society = the_satanists
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					50 = { 
						trigger = {
							can_join_society = the_trollcrafters
						}
						modifier = {
							factor = 5
							OR = {
								has_impious_trait_trigger = yes
								has_vice_trigger = yes
								trait = drunkard
								trait = possessed
								trait = lunatic
							}
						}
						modifier = {
							factor = 2
							the_trollcrafters = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							the_trollcrafters = { num_of_society_members < 10 }
						}
						join_society = the_trollcrafters
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					50 = { 
						trigger = {
							can_join_society = the_cult_of_kali
						}
						modifier = {
							factor = 5
							OR = {
								has_impious_trait_trigger = yes
								has_vice_trigger = yes
								trait = drunkard
								trait = possessed
								trait = lunatic
							}
						}
						modifier = {
							factor = 2
							the_cult_of_kali = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							the_cult_of_kali = { num_of_society_members < 10 }
						}
						join_society = the_cult_of_kali
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					50 = { 
						trigger = {
							can_join_society = the_cold_ones
						}
						modifier = {
							factor = 5
							OR = {
								has_impious_trait_trigger = yes
								has_vice_trigger = yes
								trait = drunkard
								trait = possessed
								trait = lunatic
							}
						}
						modifier = {
							factor = 2
							the_cold_ones = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							the_cold_ones = { num_of_society_members < 10 }
						}
						join_society = the_cold_ones
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					50 = {
						trigger = {
							can_join_society = the_plaguebringers
						}
						modifier = {
							factor = 5
							OR = {
								has_impious_trait_trigger = yes
								has_vice_trigger = yes
								trait = drunkard
								trait = possessed
								trait = lunatic
							}
						}
						modifier = {
							factor = 2
							the_plaguebringers = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							the_plaguebringers = { num_of_society_members < 10 }
						}
						join_society = the_plaguebringers
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					50 = {
						trigger = {
							can_join_society = the_vodouns
						}
						modifier = {
							factor = 5
							OR = {
								has_impious_trait_trigger = yes
								has_vice_trigger = yes
								trait = drunkard
								trait = possessed
								trait = lunatic
							}
						}
						modifier = {
							factor = 2
							the_vodouns = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							the_vodouns = { num_of_society_members < 10 }
						}
						join_society = the_vodouns
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
					50 = {
						trigger = {
							can_join_society = the_bacchants
						}
						modifier = {
							factor = 5
							OR = {
								has_impious_trait_trigger = yes
								has_vice_trigger = yes
								trait = drunkard
								trait = possessed
								trait = lunatic
							}
						}
						modifier = {
							factor = 2
							the_bacchants = { num_of_society_members < 15 }
						}
						modifier = {
							factor = 2
							the_bacchants = { num_of_society_members < 10 }
						}
						join_society = the_bacchants
						random_list = { # Artificially increase society influence for balance purposes
							75 = {
								modifier = {
									factor = 0
									society_influence >= 30
								}
								add_mission_succeed_influence_effect = yes
							}
							25 = {
							}
						}
						if = {
							limit = {
								NOT = {
									society = {
										any_society_member = {
											is_society_grandmaster = yes
										}
									}
								}
							}
							set_society_grandmaster = yes
						}
					}
				}
			}
		}
	}
}

#From on_character_ask_to_join_society - HEALING HUT
character_event = {
    id = MNHHN.4450
	hide_window = yes
    is_triggered_only = yes
    trigger = {
    	FROM = { leader = { society_member_of = healing_hut_north } }
    }
    immediate = {
    	FROM = { leader = { character_event = { id = MNHHN.4451 } } }
    }
}

#Ping event
character_event = {
    id = MNHHN.4451
	hide_window = yes
    is_triggered_only = yes
    immediate = {
    	FROM = { letter_event = { id = MNHHN.4452 } }
    }
}

#Welcome letter
letter_event = {
    id = MNHHN.4452
    desc = EVTDESC_MNM_4452
    border = GFX_event_letter_frame_religion

    is_triggered_only = yes
	
	immediate = { 
		set_character_flag = society_join_block
		FROM = { character_event = { id = MNHHN.4453 } }
	}
	
    option = { 
        name = EVTOPTA_MNM_44511
		join_society = healing_hut_north
		clr_character_flag = society_join_block
    }
}


narrative_event = {
	id = MNHHN.4454
	title = MNHHN_4454_TITLE
	desc = EVTDESC_MNM_4454
	
	is_triggered_only = yes
	
	option = { 
		name = found_healing_hut_north
		add_trait = healer
		add_trait = master_bender
	}
}

#MISSION: Theology focus
society_quest_event = {
	id = MNHHN.5004
	desc = EVTDESC_MNM_4015
	picture = GFX_evt_secluded_in_prayer
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	trigger = {
		NOR = {
			has_focus = focus_theology
			has_any_quest = yes
		}
	}

	option = {
		name = ACCEPT
		set_quest = quest_monastic_order_theology_focus
	}

	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

#MISSION: Recruit Member
society_quest_event = {
	id = MNHHN.5028
	desc = EVTDESC_MNHHN_5028
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes


	option = {
		name = ACCEPT
		set_quest = quest_fsv_recruit_member
	}
	option = {
		name = DECLINE

		hidden_effect = {
			add_character_modifier = {
				name = quest_cooldown_timer
				hidden = yes
				days = 1000
			}
		}
	}
}

#MISSION: Educate Family Member
society_quest_event = {
	id = MNHHN.5044
	desc = EVTDESC_MNHHN_5044
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes


	option = {
		name = ACCEPT
		set_quest = quest_fsv_educate
	}
	option = {
		name = DECLINE

		hidden_effect = {
			add_character_modifier = {
				name = quest_cooldown_timer
				hidden = yes
				days = 1000
			}
		}
	}
}

# Ask to join Healing Hut
letter_event = {
    id = MNHHN.5061
    desc = EVTDESC_MNHHN_5061
    border = GFX_event_letter_frame_religion
    is_triggered_only = yes
	
	immediate = { set_character_flag = society_join_block }
	
    option = { 
        name = EVTOPTA_MNHHN_5061
		join_society = healing_hut_north
		clr_character_flag = society_join_block
		hidden_tooltip = {
			FROMFROM = { letter_event = { id = MNHHN.5062 } }
		}
    }
	option = {
		name = EVTOPTB_MNHHN_5061
		clr_character_flag = society_join_block
		hidden_tooltip = {
			FROMFROM = { letter_event = { id = MNHHN.5063 } }
		}
		trigger = {
			ai = no
		}
	}
}

letter_event = { # POS REPLY
    id = MNHHN.5062
    desc = EVTDESC_MNHHN_5062
    border = GFX_event_letter_frame_religion
    is_triggered_only = yes
	
	immediate = { set_character_flag = society_join_block }
	
    option = { 
        name = EVTOPTA_MNHHN_5062
		hidden_tooltip = {
			if = {
				limit = { has_quest = quest_hhn_recruit_member }
				character_event = { id = MNHHN.5073 }
			}
		}
    }
}

letter_event = { # NEG REPLY
    id = MNHHN.5063
    desc = EVTDESC_MNHHN_5063
    border = GFX_event_letter_frame_religion
    is_triggered_only = yes
	
	immediate = { set_character_flag = society_join_block }
	
    option = { 
        name = EVTOPTA_MNHHN_5063
    }
}

# Healing Training - Giver
character_event = {
	id = MNHHN.5064
	desc = EVTDESC_MNHHN_5064
	picture = GFX_evt_spirit_oasis
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = { # End Training
		name = EVTOPTA_MNHHN_5064
	}
}

# Learn Healing from a Master - receiver
character_event = {
	desc = EVTDESC_MNHHN_5065
	id = MNHHN.5065
	picture = GFX_evt_spirit_oasis
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = { # End Training
		name = EVTOPTA_MNHHN_5065
	}
}