namespace = TEA

character_event = {
    id = TEA.1
	hide_window = yes
    is_triggered_only = yes
    trigger = {
    	FROM = { leader = { society_member_of = tea_enthusiasts } }
    }
    immediate = {
    	FROM = { leader = { character_event = { id = TEA.2 } } }
    }
}

#Ping event
character_event = {
    id = TEA.2
	hide_window = yes
    is_triggered_only = yes
    immediate = {
    	FROM = { letter_event = { id = TEA.3 } }
    }
}

#Welcome letter
letter_event = {
    id = TEA.3
    desc = tea_enthusiasts_welcome_letter
    border = GFX_event_letter_frame_diplomacy

    is_triggered_only = yes

	immediate = {
		set_character_flag = society_join_block
	}

    option = {
        name = tea_enthusiasts_welcome_letter_option
		join_society = tea_enthusiasts
		clr_character_flag = society_join_block
    }
}

#Choose Self or Spirit event.
narrative_event = {
	id = TEA.4
	title = choose_self_or_spirit_title
	desc = choose_self_or_spirit_desc
	border = GFX_event_narrative_frame_diplomacy
	is_triggered_only = yes
	
	trigger = { 
		society_member_of = tea_enthusiasts
		society_rank >= 2
		NOT = { days_in_society == 0 }
		NOT = { has_character_flag = tea_chose_self }
		NOT = { has_character_flag = tea_chose_spirits }
	}	
	
	option = {
		name = choose_self
		custom_tooltip = {
			text = choose_self_tooltip
			set_character_flag = tea_chose_self
		}
	}
	
	option = {
		name = choose_spirits
		custom_tooltip = {
			text = choose_spirits_tooltip
			set_character_flag = tea_chose_spirits
		}
	}
}

character_event = {
	id = TEA.10
	desc = tea_remove_envious_and_wroth_event
	border = GFX_event_normal_frame_diplomacy

	is_in_society = yes
	only_capable = yes
	
	trigger = {
		society_member_of = tea_enthusiasts
		OR = {
			trait = envious
			trait = wroth
		}
	}
	
	mean_time_to_happen = {
		months = 300
		
		modifier = {
			factor = 0.5
			diplomacy = 12
		}
		modifier = {
			factor = 0.5
			diplomacy = 14
		}
		modifier = {
			factor = 0.25
			age = 50
		}	
	}
	
	option = {
		name = tea_remove_envious_and_wroth_event_option_1
		trigger = {
			trait = envious
		}
		remove_trait = envious
	}
	
	option = {
		name = tea_remove_envious_and_wroth_event_option_2
		trigger = {
			trait = wroth
		}
		remove_trait = wroth
	}
}

character_event = {
	id = TEA.11
	desc = tea_remove_stressed
	border = GFX_event_normal_frame_diplomacy

	is_in_society = yes
	only_capable = yes
	
	trigger = {
		society_member_of = tea_enthusiasts
		trait = stressed
	}
	
	mean_time_to_happen = {
		months = 200
		
		modifier = {
			factor = 0.5
			diplomacy = 12
		}
		modifier = {
			factor = 0.5
			diplomacy = 14
		}
		modifier = {
			factor = 0.25
			age = 50
		}
	}
	
	option = {
		name = tea_remove_stressed_option
		remove_trait = stressed
	}
}

character_event = {
	id = TEA.12
	desc = tea_add_diplomacy
	border = GFX_event_normal_frame_diplomacy

	is_in_society = yes
	only_capable = yes
	
	trigger = {
		society_member_of = tea_enthusiasts
		NOT = { diplomacy = 16 }
	}
	
	mean_time_to_happen = {
		months = 1000
		
		modifier = {
			factor = 0.75
			NOT = { diplomacy = 12 }
		}
		modifier = {
			factor = 0.75
			NOT = { diplomacy = 14 }
		}
		modifier = {
			factor = 0.75
			age = 50
		}
	}
	
	option = {
		name = tea_add_diplomacy_option
		change_diplomacy = 1
	}
}
#100 -> DECISION EVENTS
#Share Tea
letter_event = {
	id = TEA.100
	is_triggered_only = yes
	desc = share_tea_letter_event
	
	option = {
		desc = share_tea_letter_event_accept
		hidden_tooltip = {
			clr_character_flag = removed_negative_trait
			if = {
				limit = {
					OR = {
						trait = wroth
						trait = stressed
					}
				}
				set_character_flag = removed_negative_trait
				remove_trait = wroth
				remove_trait = stressed
			}
		}
		
		opinion = {
			modifier = opinion_improved_relations
			who = event_target:tea_friend
			years = 2
		}

		custom_tooltip = {
			text = can_make_into_friend
			hidden_tooltip = {
				random_list = {
					90 = {}
					10 = {
						modifier = { has_character_flag = removed_negative_trait factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_remove_negative_trait } factor = 3 }
						modifier = { event_target:tea_friend = { trait = tea_master } factor = 3 }
						save_event_target_as = helped_tea_friend
						event_target:tea_friend = { letter_event = { id = TEA.110 days = 3 } }
					}
				}
			}
		}
		
		if = {
			limit = {
				has_character_flag = removed_negative_trait
				event_target:tea_friend = { has_quest = quest_remove_negative_trait }
			}
			event_target:tea_friend = { character_event = { id = TEA.1101 } }
		}
		add_character_modifier = {
			name = had_tea_recently
			days = 730
		}
	}
	
	option = {
		desc = share_tea_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

#Brew Enlightening Tea
letter_event = {
	id = TEA.101
	is_triggered_only = yes
	desc = share_tea_letter_event
	
	option = {
		desc = share_tea_letter_event_accept
		custom_tooltip = {
			text = enlightening_tea_tooltip
			hidden_tooltip = {
				clr_character_flag = removed_negative_trait
				if = {
					limit = {
						OR = {
							trait = wroth
							trait = envious
						}
					}
					set_character_flag = removed_negative_trait
					remove_trait = wroth
					remove_trait = envious
				} else = {
					set_character_flag = add_kind
					add_trait = kind
				}
			}
		}
		
		opinion = {
			modifier = opinion_improved_relations
			who = event_target:tea_friend
			years = 2
		}

		custom_tooltip = {
			text = can_make_into_friend
			hidden_tooltip = {
				random_list = {
					90 = {}
					10 = {
						modifier = { has_character_flag = removed_negative_trait factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_remove_negative_trait } factor = 3 }
						modifier = { event_target:tea_friend = { trait = tea_master } factor = 3 }
						save_event_target_as = helped_tea_friend
						event_target:tea_friend = { letter_event = { id = TEA.110 days = 3 } }
					}
				}
			}
		}
		
		if = {
			limit = {
				has_character_flag = removed_negative_trait
				event_target:tea_friend = { has_quest = quest_remove_negative_trait }
			}
			event_target:tea_friend = { character_event = { id = TEA.1101 } }
		}
		
		if = {
			limit = {
				has_character_flag = add_kind
				event_target:tea_friend = { has_quest = quest_teach_kindness }
			}
			event_target:tea_friend = { character_event = { id = TEA.1103 } }
		}
		add_character_modifier = {
			name = had_tea_recently
			days = 730
		}
	}
	
	option = {
		desc = share_tea_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

#Brew Spiritual Tea
letter_event = {
	id = TEA.102
	is_triggered_only = yes
	desc = share_tea_letter_event
	
	option = {
		desc = share_tea_letter_event_accept
		hidden_tooltip = {
			clr_character_flag = removed_negative_trait
			if = {
				limit = {
					OR = {
						trait = insane
						trait = possessed
						trait = depressed
					}
				}
				set_character_flag = removed_negative_trait

			}
		}
		remove_trait = insane
		remove_trait = possessed
		remove_trait = depressed		
		opinion = {
			modifier = opinion_improved_relations
			who = event_target:tea_friend
			years = 2
		}

		custom_tooltip = {
			text = can_make_into_friend
			hidden_tooltip = {
				random_list = {
					90 = {}
					10 = {
						modifier = { has_character_flag = removed_negative_trait factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_remove_negative_trait } factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_heal_broken_mind } factor = 3 }
						modifier = { event_target:tea_friend = { trait = tea_master } factor = 3 }
						save_event_target_as = helped_tea_friend
						event_target:tea_friend = { letter_event = { id = TEA.110 days = 3 } }
					}
				}
			}
		}
		
		if = {
			limit = {
				has_character_flag = removed_negative_trait
				event_target:tea_friend = { has_quest = quest_remove_negative_trait }
			}
			event_target:tea_friend = { character_event = { id = TEA.1101 } }
		}
		if = {
			limit = {
				has_character_flag = removed_negative_trait
				event_target:tea_friend = { has_quest = quest_heal_broken_mind }
			}
			event_target:tea_friend = { character_event = { id = TEA.1107 } }
		}
		add_character_modifier = {
			name = had_tea_recently
			days = 730
		}
	}
	
	option = {
		desc = share_tea_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

#Educate -- Upgrade Trait
letter_event = {
	id = TEA.103
	is_triggered_only = yes
	desc = educate_letter_event
	
	option = {
		desc = educate_letter_event_accept
		custom_tooltip = {
			text = improve_education
			hidden_tooltip = {
				trigger_switch = {
					on_trigger = trait
					detached_priest = {
						set_character_flag = lowest_level_upgrade
						remove_trait = detached_priest
						add_trait = martial_cleric
					}
					martial_cleric = {
						remove_trait = martial_cleric
						add_trait = scholarly_theologian
					}
					scholarly_theologian = {
						remove_trait = scholarly_theologian
						add_trait = mastermind_theologian
					}
					misguided_warrior = {
						set_character_flag = lowest_level_upgrade
						remove_trait = misguided_warrior
						add_trait = tough_soldier
					}
					tough_soldier = {
						remove_trait = tough_soldier
						add_trait = skilled_tactician
					}
					skilled_tactician = {
						remove_trait = skilled_tactician
						add_trait = brilliant_strategist
					}
					indulgent_wastrel = {
						set_character_flag = lowest_level_upgrade
						remove_trait = indulgent_wastrel
						add_trait = thrifty_clerk
					}
					thrifty_clerk = {
						remove_trait = thrifty_clerk
						add_trait = fortune_builder
					}
					fortune_builder = {
						remove_trait = fortune_builder
						add_trait = midas_touched
					}
					naive_appeaser = {
						set_character_flag = lowest_level_upgrade
						remove_trait = naive_appeaser
						add_trait = underhanded_rogue
					}
					underhanded_rogue = {
						remove_trait = underhanded_rogue
						add_trait = charismatic_negotiator
					}
					charismatic_negotiator = {
						remove_trait = charismatic_negotiator
						add_trait = grey_eminence
					}
					amateurish_plotter = {
						remove_trait = amateurish_plotter
						add_trait = flamboyant_schemer
					}		
					flamboyant_schemer = {
						remove_trait = flamboyant_schemer
						add_trait = intricate_webweaver
					}
					intricate_webweaver = {
						remove_trait = intricate_webweaver
						add_trait = elusive_shadow
					}
				}
			}
		}
		if = {
			limit = {
				has_character_flag = lowest_level_upgrade
				event_target:tea_friend = { has_quest = quest_educate }
			}
			event_target:tea_friend = { character_event = { id = TEA.1104 } }
		}
		add_character_modifier = {
			name = had_been_educated_lately
			days = 730
		}
	}
	
	option = {
		desc = educate_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

#Brew Herbal Tea
letter_event = {
	id = TEA.104
	is_triggered_only = yes
	desc = share_tea_letter_event
	option = {
		desc = share_tea_letter_event_accept
		hidden_tooltip = {
			clr_character_flag = removed_negative_trait
			if = {
				limit = {
					poorly_treated_for_disease_trigger = yes
				}
				set_character_flag = removed_negative_trait		
			}
		}
		
		remove_character_modifier = failed_treatment_1
		remove_character_modifier = failed_treatment_2
		remove_character_modifier = mystic_treatment_poor
		remove_character_modifier = mystic_treatment_terrible
		
		add_character_modifier = {
			name = had_herbal_tea
			days = 730
		}

		opinion = {
			modifier = opinion_improved_relations
			who = event_target:tea_friend
			years = 2
		}

		custom_tooltip = {
			text = can_make_into_friend
			hidden_tooltip = {
				random_list = {
					90 = {}
					10 = {
						modifier = { has_character_flag = removed_negative_trait factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_remove_negative_trait } factor = 3 }
						modifier = { event_target:tea_friend = { trait = tea_master } factor = 3 }
						save_event_target_as = helped_tea_friend
						event_target:tea_friend = { letter_event = { id = TEA.110 days = 3 } }
					}
				}
			}
		}
		
		if = {
			limit = {
				has_character_flag = removed_negative_trait
				event_target:tea_friend = { has_quest = quest_remove_negative_trait }
			}
			event_target:tea_friend = { character_event = { id = TEA.1101 } }
		}
		
		if = {
			limit = {
				has_children = no
				is_married = yes
				event_target:tea_friend = { has_quest = quest_help_with_fertility }
			}
			trait = lust
			event_target:tea_friend = { character_event = { id = TEA.1108 } }
		}
		add_character_modifier = {
			name = had_tea_recently
			days = 730
		}
	}
	
	option = {
		desc = share_tea_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

letter_event = {
	id = TEA.105
	is_triggered_only = yes
	desc = improve_bending_letter_event
	
	option = {
		desc = improve_bending_event_accept
		custom_tooltip = {
			text = improve_bending_tea
			hidden_tooltip = {
				set_character_flag = had_chi_enhancing_tea
				trigger_switch = {
					on_trigger = trait
					incompetent_bender = {
						remove_trait = incompetent_bender
						add_trait = competent_bender
					}
					competent_bender = {
						remove_trait = competent_bender
						add_trait = powerful_bender
					}
					powerful_bender = {
						remove_trait = powerful_bender
						add_trait = master_bender
					}
				}
			}
		}
		
		opinion = {
			modifier = opinion_improved_relations
			who = event_target:tea_friend
			years = 2
		}

		custom_tooltip = {
			text = can_make_into_friend
			hidden_tooltip = {
				random_list = {
					90 = {}
					10 = {
						modifier = { has_character_flag = removed_negative_trait factor = 3 }
						modifier = { event_target:tea_friend = { has_quest = quest_remove_negative_trait } factor = 3 }
						modifier = { event_target:tea_friend = { trait = tea_master } factor = 3 }
						save_event_target_as = helped_tea_friend
						event_target:tea_friend = { letter_event = { id = TEA.110 days = 3 } }
					}
				}
			}
		}
		add_character_modifier = {
			name = had_tea_recently
			days = 730
		}
	}
	
	option = {
		desc = share_tea_letter_event_reject
		ai_chance = {
        	factor = 0
		}
	}
}

#Become friends after sharing tea!
letter_event = {
	id = TEA.110
	is_triggered_only = yes
	desc = share_tea_letter_friend_event
	
	option = {
		name = share_tea_letter_friend_event_option
		add_friend = event_target:helped_tea_friend
	}
}

# 1000 : QUEST EVENTS
character_event = {
	id = TEA.1000
	hide_window = yes

	is_triggered_only = yes
	is_in_society = yes
	only_capable = yes

	trigger = {
		is_society_grandmaster = no
		has_any_quest = no
		NOT = { is_inaccessible_trigger = yes }
		NOT = { has_character_modifier = quest_cooldown_timer }	
	}

	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		grandmaster = { character_event = { id = TEA.2000 } }	
	}
}

#toombla
character_event = {
	id = TEA.2000
	hide_window = yes

	is_triggered_only = yes
	is_in_society = yes
	only_capable = yes
	
	immediate = {
		FROM = {
			random_list = {
				30 = {}
				10 = { # Share Tea
					modifier = {
						factor = 0
						OR = {
							has_character_flag = tea_chose_self
							has_character_flag = tea_chose_spirits
						}
					}				
					character_event = { id = TEA.1001 }
				}
				
				# PATH OF SELF
				
				50 = { # Rest for an Afternoon
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_self }
					}
					modifier = {
						factor = 0
						OR = {
							AND = {
								society_rank == 2
								OR = {
									trait = underhanded_rogue
									trait = charismatic_negotiator
									trait = grey_eminence
								}
							}
							AND = {
								society_rank == 3
								OR = {
									trait = charismatic_negotiator
									trait = grey_eminence
								}
							}
							AND = {
								society_rank == 4
								trait = grey_eminence
							}
						}
					}
					character_event = { id = TEA.1002 }
				}
				10 = { # Teach Kindness
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_self }
					}
					
					character_event = { id = TEA.1003 }
				}
				10 = { # Educate Someone in Need
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_self }
					}
					modifier = {
						factor = 0
						society_rank < 3
					}	
					character_event = { id = TEA.1004 }
				}
				10 = { # Take the Family Focus
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_self }
					}
					modifier = {
						factor = 0
						has_focus = focus_family
					}
					modifier = {
						factor = 10
						NOT = { has_focus = focus_family }
					}
					character_event = { id = TEA.1005 }
				}
				
				# PATH OF SPIRITS

				50 = { # Take Tea Near the Spirits
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_spirits }
					}
					modifier = {
						factor = 0
						OR = {
							AND = {
								society_rank == 2
								OR = {
									trait = martial_cleric
									trait = scholarly_theologian
									trait = mastermind_theologian
								}
							}
							AND = {
								society_rank == 3
								OR = {
									trait = scholarly_theologian
									trait = mastermind_theologian
								}
							}
							AND = {
								society_rank == 4
								trait = mastermind_theologian
							}
						}
					}
					character_event = { id = TEA.1006 }
				}
				
				10 = { # Heal a Broken Mind
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_spirits }
					}
					
					character_event = { id = TEA.1007 }
				}
				10 = { # Help Someone With Fertility
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_spirits }
					}
					modifier = {
						factor = 0
						society_rank < 3
					}	
					character_event = { id = TEA.1008 }
				}				
				10 = { # Take the Theology Focus
					modifier = {
						factor = 0
						NOT = { has_character_flag = tea_chose_spirits }
					}
					modifier = {
						factor = 0
						has_focus = focus_theology
					}
					modifier = {
						factor = 10
						NOT = { has_focus = focus_theology }
					}
					character_event = { id = TEA.1009 }
				}
				10 = { # Have A Cup of Tea IRL
					modifier = {
						factor = 0
						NOT = { society_rank == 4 }
					}
					modifier = {
						factor = 0
						ai = yes
					}
					modifier = {
						factor = 0
						has_global_flag = asked_to_make_tea_irl
					}
					character_event = { id = TEA.1010 }
				}
			}
		}
	}
}

#Share Tea with Someone in Pain
society_quest_event = {
	id = TEA.1001
	desc = quest_remove_negative_trait_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_remove_negative_trait
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1101

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1201 } }	
	}
}

character_event = {
	id = TEA.1201
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1301 } }
	}
}

letter_event = {
	id = TEA.1301
	desc = quest_remove_negative_trait_event_success
	border = GFX_event_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = quest_remove_negative_trait_event_success_option
		clr_quest = quest_remove_negative_trait
		change_society_currency = 200
	}
}

#Relaxing Afternoon
society_quest_event = {
	id = TEA.1002
	desc = quest_relaxing_afternoon_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_relaxing_afternoon
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1102

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1202 } }	
	}
}

character_event = {
	id = TEA.1202
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1302 } }
	}
}

letter_event = {
	id = TEA.1302
	desc = quest_relaxing_afternoon_success
	border = GFX_event_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = quest_relaxing_afternoon_success_option
		clr_quest = quest_relaxing_afternoon
		change_society_currency = 100
		clr_character_flag = relaxing_afternoon
	}
}

#Teach Kindness
society_quest_event = {
	id = TEA.1003
	desc = quest_teach_kindness_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_teach_kindness
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1103

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1203 } }	
	}
}

character_event = {
	id = TEA.1203
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1303 } }
	}
}

letter_event = {
	id = TEA.1303
	desc = quest_teach_kindness_success
	border = GFX_event_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = quest_teach_kindness_success_option
		clr_quest = quest_teach_kindness
		change_society_currency = 200
	}
}

#Educate Someone in Need
society_quest_event = {
	id = TEA.1004
	desc = quest_educate_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_teach_kindness
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1104

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1204 } }	
	}
}

character_event = {
	id = TEA.1204
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1304 } }
	}
}

letter_event = {
	id = TEA.1304
	desc = quest_educate_success
	border = GFX_event_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = quest_educate_success_option
		clr_quest = quest_educate
		change_society_currency = 100
	}
}

#Take the Family Focus
society_quest_event = {
	id = TEA.1005
	desc = quest_family_focus_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_family_focus
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1105

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1205 } }	
	}
}

character_event = {
	id = TEA.1205
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1305 } }
	}
}

letter_event = {
	id = TEA.1305
	desc = quest_family_focus_success
	border = GFX_event_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = quest_family_focus_success_option
		clr_quest = quest_take_family_focus
		change_society_currency = 100
	}
}

#Take Tea Near the Spirits
society_quest_event = {
	id = TEA.1006
	desc = quest_tea_near_the_spirits_event
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_tea_near_the_spirits
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1106

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1206 } }	
	}
}

character_event = {
	id = TEA.1206
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1306 } }
	}
}

letter_event = {
	id = TEA.1306
	desc = quest_tea_near_the_spirits_success
	border = GFX_event_letter_frame_religion
	is_triggered_only = yes
	
	option = {
		name = quest_tea_near_the_spirits_option_learning
		clr_quest = quest_tea_near_the_spirits
		change_society_currency = 100
		change_learning = 1
		clr_character_flag = tea_near_the_spirits
	}
	
	option = {
		name = quest_tea_near_the_spirits_option_piety
		clr_quest = quest_tea_near_the_spirits
		change_society_currency = 100
		piety = 100
		clr_character_flag = tea_near_the_spirits
	}
}

#Heal a Broken Mind
society_quest_event = {
	id = TEA.1007
	desc = quest_heal_broken_mind_event
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_heal_broken_mind
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1107

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1207 } }	
	}
}

character_event = {
	id = TEA.1207
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1307 } }
	}
}

letter_event = {
	id = TEA.1307
	desc = quest_heal_broken_mind_success
	border = GFX_event_letter_frame_religion
	is_triggered_only = yes
	
	option = {
		name = quest_heal_broken_mind_success_option
		clr_quest = quest_heal_broken_mind
		change_society_currency = 400
		trait = kind
	}
}

#Help Someone With Fertility
society_quest_event = {
	id = TEA.1008
	desc = quest_help_with_fertility_event
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_help_with_fertility
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1108

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1208 } }	
	}
}

character_event = {
	id = TEA.1208
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1308 } }
	}
}

letter_event = {
	id = TEA.1308
	desc = quest_help_with_fertility_success
	border = GFX_event_letter_frame_religion
	is_triggered_only = yes
	
	option = {
		name = quest_help_with_fertility_success_option
		clr_quest = quest_help_with_fertility
		change_society_currency = 400
	}
}

#Take the Theology Focus
society_quest_event = {
	id = TEA.1009
	desc = quest_theology_focus_event
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_theology_focus
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = TEA.1109

	hide_window = yes 
	is_triggered_only = yes
	
	immediate = {
		random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = grandmaster
		}
		
		event_target:grandmaster = { character_event = { id = TEA.1209 } }	
	}
}

character_event = {
	id = TEA.1209
	
	hide_window = yes 
	is_triggered_only = yes

	immediate = {
		FROM = { letter_event = { id = TEA.1309 } }
	}
}

letter_event = {
	id = TEA.1309
	desc = quest_theology_focus_success
	border = GFX_event_letter_frame_religion
	is_triggered_only = yes
	
	option = {
		name = quest_theology_focus_success_option
		clr_quest = quest_take_theology_focus
		change_society_currency = 100
	}
}

#Share Tea with Someone in Pain
society_quest_event = {
	id = TEA.1010
	desc = quest_have_a_cup_of_tea_event
	border = GFX_event_letter_frame_diplomacy

	is_triggered_only = yes

	option = {
		name = ACCEPT
		set_quest = quest_have_a_cup_of_tea
	}
	option = {
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		add_character_modifier = {
			name = quest_cooldown_timer
			hidden = yes
			days = 1000
		}

		ai_chance = { factor = 0 }
	}
}

# DECISION EVENTS

# Relaxing Afternoon
character_event = {
	id = TEA.10000
	desc = relaxing_afternoon_event
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes

	option = {
		name = relaxing_afternoon_event_get_diplo_education
		trigger = {
			NOR = {
				trait = naive_appeaser
				trait = underhanded_rogue
				trait = charismatic_negotiator
				trait = grey_eminence			
			}
		}
	
		custom_tooltip = {
			text = tea_society_remove_education
			hidden_tooltip = {
				character_event = { id = TEA.10010 }
			}
		}
		add_trait = underhanded_rogue
		character_event = { id = TEA.1102 }
	}
	
	option = {
		name = relaxing_afternoon_event_improve_diplo_education
		trigger = {
			OR = {
				trait = naive_appeaser
				trait = underhanded_rogue
				trait = charismatic_negotiator
			}
		}	
		trigger_switch = {
			on_trigger = trait
			naive_appeaser = {
				remove_trait = naive_appeaser
				add_trait = underhanded_rogue
			}
			underhanded_rogue = {
				remove_trait = underhanded_rogue
				add_trait = charismatic_negotiator
			}
			charismatic_negotiator = {
				remove_trait = charismatic_negotiator
				add_trait = grey_eminence
			}
		}
		character_event = { id = TEA.1102 }
	}
	
	option = {
		name = relaxing_afternoon_event_improve_learning_education
		trigger = {
			OR = {
				trait = detached_priest
				trait = martial_cleric
				trait = scholarly_theologian
			}
		}
		
		random_list = {
			25 = {}
			75 = {
				trigger_switch = {
					on_trigger = trait
					detached_priest = {
						remove_trait = detached_priest
						add_trait = martial_cleric
					}
					martial_cleric = {
						remove_trait = martial_cleric
						add_trait = scholarly_theologian
					}
					scholarly_theologian = {
						remove_trait = scholarly_theologian
						add_trait = mastermind_theologian
					}
				}
			}
		}
		character_event = { id = TEA.1102 }
	}

	option = {
		name = relaxing_afternoon_event_improve_stewardship_education
		trigger = {
			OR = {
				trait = indulgent_wastrel
				trait = thrifty_clerk
				trait = fortune_builder
			}
		}
		
		random_list = {
			75 = {}
			25 = {
				trigger_switch = {
					on_trigger = trait
					indulgent_wastrel = {
						remove_trait = indulgent_wastrel
						add_trait = thrifty_clerk
					}
					thrifty_clerk = {
						remove_trait = thrifty_clerk
						add_trait = fortune_builder
					}
					fortune_builder = {
						remove_trait = fortune_builder
						add_trait = midas_touched
					}
				}
			}
		}
		character_event = { id = TEA.1102 }
	}
	
	option = {
		name = relaxing_afternoon_event_no_change
		character_event = { id = TEA.1102 }
	}
}

#Remove all educations
character_event = {
	id = TEA.10010
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		remove_trait = amateurish_plotter
		remove_trait = flamboyant_schemer
		remove_trait = intricate_webweaver
		remove_trait = elusive_shadow
		remove_trait = naive_appeaser
		remove_trait = underhanded_rogue
		remove_trait = charismatic_negotiator
		remove_trait = grey_eminence
		remove_trait = indulgent_wastrel
		remove_trait = thrifty_clerk
		remove_trait = fortune_builder
		remove_trait = midas_touched
		remove_trait = misguided_warrior
		remove_trait = tough_soldier
		remove_trait = skilled_tactician
		remove_trait = brilliant_strategist
		remove_trait = detached_priest
		remove_trait = martial_cleric
		remove_trait = scholarly_theologian
		remove_trait = mastermind_theologian
	}
}

character_event = {
	id = TEA.10001
	desc = tea_near_the_spirits_event
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = tea_near_the_spirits_event_get_learning_education
		trigger = {
			NOR = {
				trait = detached_priest
				trait = martial_cleric
				trait = scholarly_theologian
				trait = mastermind_theologian			
			}
		}
	
		custom_tooltip = {
			text = tea_society_remove_education
			hidden_tooltip = {
				character_event = { id = TEA.10010 }
			}
		}
		add_trait = detached_priest
		character_event = { id = TEA.1106 }
	}
	
	option = {
		name = tea_near_the_spirits_event_improve_learning_education
		trigger = {
			OR = {
				trait = detached_priest
				trait = martial_cleric
				trait = scholarly_theologian
			}
		}	
		trigger_switch = {
			on_trigger = trait
			detached_priest = {
				remove_trait = detached_priest
				add_trait = martial_cleric
			}
			martial_cleric = {
				remove_trait = martial_cleric
				add_trait = scholarly_theologian
			}
			scholarly_theologian = {
				remove_trait = scholarly_theologian
				add_trait = mastermind_theologian
			}
		}
		character_event = { id = TEA.1106 }
	}
	
	option = {
		name = tea_near_the_spirits_event_improve_diplomacy_education
		trigger = {
			OR = {
				trait = naive_appeaser
				trait = underhanded_rogue
				trait = charismatic_negotiator
			}
		}	
		
		random_list = {
			25 = {}
			75 = {

				trigger_switch = {
					on_trigger = trait
					naive_appeaser = {
						remove_trait = naive_appeaser
						add_trait = underhanded_rogue
					}
					underhanded_rogue = {
						remove_trait = underhanded_rogue
						add_trait = charismatic_negotiator
					}
					charismatic_negotiator = {
						remove_trait = charismatic_negotiator
						add_trait = grey_eminence
					}
				}
			}
		}
		character_event = { id = TEA.1106 }
	}

	option = {
		name = tea_near_the_spirits_event_improve_intrigue_education
		trigger = {
			OR = {
				trait = amateurish_plotter
				trait = flamboyant_schemer
				trait = intricate_webweaver
			}
		}
		
		random_list = {
			75 = {}
			25 = {
				trigger_switch = {
					on_trigger = trait
					amateurish_plotter = {
						remove_trait = amateurish_plotter
						add_trait = flamboyant_schemer
					}
					flamboyant_schemer = {
						remove_trait = flamboyant_schemer
						add_trait = intricate_webweaver
					}
					intricate_webweaver = {
						remove_trait = intricate_webweaver
						add_trait = elusive_shadow
					}
				}
			}
		}
		character_event = { id = TEA.1106 }
	}
	
	option = {
		name = tea_near_the_spirits_event_no_change
		character_event = { id = TEA.1106 }
	}
}

character_event = {
	id = TEA.10002
	desc = quest_have_a_cup_of_tea_success
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes

	option = {
		name = quest_have_a_cup_of_tea_made
		character_event = { id = TEA.11002 }
	}
	
	option = {
		name = quest_have_a_cup_of_tea_not_made
		character_event = { id = TEA.12002 }
	}
}

character_event = {
	id = TEA.11002
	desc = quest_have_a_cup_of_tea_made_event
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes

	option = {
		name = quest_have_a_cup_of_tea_made_option
		change_society_currency = 300
		clr_quest = quest_have_a_cup_of_tea
		clr_character_flag = made_tea_irl
		set_global_flag = asked_to_make_tea_irl
	}
}

character_event = {
	id = TEA.12002
	desc = quest_have_a_cup_of_tea_not_made_event
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes

	option = {
		name = quest_have_a_cup_of_tea_not_made_option
		change_society_currency = 100
		trait = honest
		clr_quest = quest_have_a_cup_of_tea
		clr_character_flag = made_tea_irl
		set_global_flag = asked_to_make_tea_irl
	}
}

character_event = {
	id = TEA.10003
	desc = tea_build_plantation_1_start
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_1_start_option_gold_1
		wealth = -100
		custom_tooltip = { text = tea_build_plantation_1_perfect_success_tooltip }
		character_event = { id = TEA.11003 days = 360 random = 30 }		
	}
	option = {
		name = tea_build_plantation_1_start_option_gold_2
		wealth = -50
		custom_tooltip = { 
			text = tea_build_plantation_1_high_success_tooltip 
			hidden_tooltip = {
				random_list = {
					10 = { character_event = { id = TEA.12003 days = 548 random = 60 } }
					90 = { character_event = { id = TEA.11003 days = 548 random = 60 } }
				}
			}
		}	
	}
	option = {
		name = tea_build_plantation_1_start_option_gold_3
		custom_tooltip = { 
			text = tea_build_plantation_1_medium_success_tooltip 
			hidden_tooltip = {
				random_list = {
					50 = { character_event = { id = TEA.12003 days = 720 random = 90 } }
					50 = { character_event = { id = TEA.11003 days = 720 random = 90 } }
				}
			}
		}
	}
}

character_event = {
	id = TEA.11003
	desc = tea_build_plantation_1_finish
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_1_finish_option
		remove_trait = stressed
		capital_holding = {
			add_building = tea_plantation_1
		}
		custom_tooltip = {
			text = can_build_tea_shop_1
		}
	}
}

character_event = {
	id = TEA.12003
	desc = tea_build_plantation_1_fail
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_1_fail_option
		custom_tooltip = {
			text = tea_currency_refunded
			hidden_tooltip = {
				change_society_currency = 1000
			}
		}
	}
}

character_event = {
	id = TEA.10004
	desc = tea_build_plantation_2_start
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_2_start_option_gold
		wealth = -200
		custom_tooltip = { 
			text = tea_build_plantation_2_high_success_gold_tooltip 
			hidden_tooltip = {
				random_list = {
					10 = { character_event = { id = TEA.12004 days = 548 random = 60 } }
					90 = { character_event = { id = TEA.11004 days = 548 random = 60 } }
				}
			}
		}
	}
	
	option = {
		name = tea_build_plantation_2_start_option_self
		
		trigger = {
			has_character_flag = tea_chose_self
		}
		prestige = -300
		tooltip_info = diplomacy
		custom_tooltip = { 
			text = tea_build_plantation_2_high_success_self_tooltip 
			
			hidden_tooltip = {
				random_list = {
					10 = { character_event = { id = TEA.12004 days = 548 random = 60 } }
					90 = { character_event = { id = TEA.11004 days = 548 random = 60 } }
				}
			}
		}
	}
	
	option = {
		name = tea_build_plantation_2_start_option_spirits
		
		trigger = {
			has_character_flag = tea_chose_spirits
		}
		piety = -200
		

		custom_tooltip = { 
			text = tea_build_plantation_2_high_success_spirits_tooltip 
			tooltip_info = learning
			hidden_tooltip = {
				random_list = {
					10 = { character_event = { id = TEA.12004 days = 548 random = 60 } }
					90 = { character_event = { id = TEA.11004 days = 548 random = 60 } }
				}
			}
		}
	}
	
	option = {
		name = tea_build_plantation_2_start_option_free
		
		custom_tooltip = { 
			text = tea_build_plantation_2_low_success_free_tooltip 
			hidden_tooltip = {
				random_list = {
					70 = { character_event = { id = TEA.12004 days = 548 random = 60 } }
					30 = { character_event = { id = TEA.11004 days = 548 random = 60 } }
				}
			}
		}
	}
	
	option = {
		name = tea_build_plantation_2_start_option_bail
		
		custom_tooltip = { 
			text = tea_currency_refunded 
			hidden_tooltip = {
				change_society_currency = 1500
			}
		}
	}
}

character_event = {
	id = TEA.11004
	desc = tea_build_plantation_2_finish
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_2_finish_option_self
		
		trigger = {
			has_character_flag = tea_chose_self
		}
		
		add_trait = gardener
		capital_holding = {
			add_building = tea_plantation_2
		}
		custom_tooltip = {
			text = can_build_tea_shop_2
		}
	}
	
	option = {
		name = tea_build_plantation_2_finish_option_spirits
		
		trigger = {
			has_character_flag = tea_chose_spirits
		}
		
		add_trait = mystic
		capital_holding = {
			add_building = tea_plantation_2
		}
		custom_tooltip = {
			text = can_build_tea_shop_2
		}
	}
}

character_event = {
	id = TEA.12004
	desc = tea_build_plantation_2_fail
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_2_fail_option
		custom_tooltip = {
			text = tea_currency_refunded
			hidden_tooltip = {
				change_society_currency = 1500
			}
		}
	}
}

character_event = {
	id = TEA.10005
	desc = tea_build_plantation_3_start_1
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes
	
	option = {
		name = tea_build_plantation_3_start_1_option
		character_event = { id = TEA.11005 days = 5 }		
	}	
}

character_event = {
	id = TEA.11005
	desc = tea_build_plantation_3_start_2
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_3_start_option_gold_1
		wealth = -800
		custom_tooltip = { 
			text = tea_build_plantation_3_high_success_gold 
			hidden_tooltip = {
				random_list = {
					20 = { character_event = { id = TEA.13005 days = 1460 random = 365 } }
					80 = { character_event = { id = TEA.12005 days = 1460 random = 365 } }
				}
			}
		}	
	}
	option = {
		name = tea_build_plantation_3_start_option_self
		prestige = -1000
		custom_tooltip = { 
			text = tea_build_plantation_3_high_success_self 
			hidden_tooltip = {
				random_list = {
					10 = { character_event = { id = TEA.13005 days = 1460 random = 365 } }
					90 = { character_event = { id = TEA.12005 days = 1460 random = 365 } }
				}
			}
		}	
	}
	option = {
		name = tea_build_plantation_3_start_option_spirits
		piety = -800
		custom_tooltip = { 
			text = tea_build_plantation_3_high_success_spirits
			hidden_tooltip = {
				random_list = {
					10 = { character_event = { id = TEA.13005 days = 1460 random = 365 } }
					90 = { character_event = { id = TEA.12005 days = 1460 random = 365 } }
				}
			}
		}	
	}
	option = {
		name = tea_build_plantation_3_start_option_gold_2
		wealth = -300
		custom_tooltip = { 
			text = tea_build_plantation_3_low_success_gold 
			hidden_tooltip = {
				random_list = {
					70 = { character_event = { id = TEA.13005 days = 1460 random = 365 } }
					30 = { character_event = { id = TEA.12005 days = 1460 random = 365 } }
				}
			}
		}	
	}
	option = {
		name = tea_build_plantation_3_start_option_bail
		
		custom_tooltip = { 
			text = tea_currency_refunded 
			hidden_tooltip = {
				change_society_currency = 2000
			}
		}
	}
}

character_event = {
	id = TEA.12005
	desc = tea_build_plantation_3_finish
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_3_finish_option_self
		
		trigger = {
			has_character_flag = tea_chose_self
		}
		
		add_trait = honest
		capital_holding = {
			add_building = tea_plantation_3
		}
		custom_tooltip = {
			text = can_build_tea_shop_3
		}
	}
	
	option = {
		name = tea_build_plantation_3_finish_option_spirits
		
		trigger = {
			has_character_flag = tea_chose_spirits
		}
		
		add_trait = zealous
		capital_holding = {
			add_building = tea_plantation_3
		}
		custom_tooltip = {
			text = can_build_tea_shop_3
		}
	}
}

character_event = {
	id = TEA.13005
	desc = tea_build_plantation_3_fail
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_3_fail_option
		custom_tooltip = {
			text = tea_currency_refunded
			hidden_tooltip = {
				change_society_currency = 2000
			}
		}
	}
}


character_event = {
	id = TEA.10006
	desc = tea_build_plantation_4_start_1
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes
	
	option = {
		name = tea_build_plantation_4_start_1_option
		character_event = { id = TEA.11006 days = 5 }		
	}	
}

character_event = {
	id = TEA.11006
	desc = tea_build_plantation_4_start_2
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_4_start_option_gold_1
		wealth = -2000
		custom_tooltip = { 
			text = tea_build_plantation_4_high_success_gold 
			hidden_tooltip = {
				random_list = {
					30 = { character_event = { id = TEA.13006 days = 2920 random = 730 } }
					70 = { character_event = { id = TEA.12006 days = 2920 random = 730 } }
				}
			}
		}	
	}
	option = {
		name = tea_build_plantation_4_start_option_self
		wealth = -750
		prestige = -2000
		custom_tooltip = { 
			text = tea_build_plantation_4_high_success_self 
			hidden_tooltip = {
				random_list = {
					20 = { character_event = { id = TEA.13006 days = 2920 random = 730 } }
					80 = { character_event = { id = TEA.12006 days = 2920 random = 730 } }
				}
			}
		}	
	}
	option = {
		name = tea_build_plantation_4_start_option_spirits
		wealth = -750
		piety = -1500
		custom_tooltip = { 
			text = tea_build_plantation_4_high_success_spirits
			hidden_tooltip = {
				random_list = {
					20 = { character_event = { id = TEA.13006 days = 2920 random = 730 } }
					80 = { character_event = { id = TEA.12006 days = 2920 random = 730 } }
				}
			}
		}	
	}
	option = {
		name = tea_build_plantation_4_start_option_gold_2
		wealth = -750
		custom_tooltip = { 
			text = tea_build_plantation_4_low_success_gold 
			hidden_tooltip = {
				random_list = {
					80 = { character_event = { id = TEA.13006 days = 2920 random = 730 } }
					20 = { character_event = { id = TEA.12006 days = 2920 random = 730 } }
				}
			}
		}	
	}
	option = {
		name = tea_build_plantation_4_start_option_bail
		
		custom_tooltip = { 
			text = tea_currency_refunded 
			hidden_tooltip = {
				change_society_currency = 2500
			}
		}
	}
}

narrative_event = {
	id = TEA.12006
	desc = tea_build_plantation_4_finish
	title = tea_lord_title
	border = GFX_event_narrative_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_4_finish_option

		capital_holding = {
			add_building = tea_plantation_4
		}
		custom_tooltip = {
			text = can_build_tea_shop_4
		}
	}

}

character_event = {
	id = TEA.13005
	desc = tea_build_plantation_4_fail
	border = GFX_event_normal_frame_diplomacy
	picture = GFX_evt_garden
	is_triggered_only = yes

	option = {
		name = tea_build_plantation_4_fail_option
		custom_tooltip = {
			text = tea_currency_refunded
			hidden_tooltip = {
				change_society_currency = 2500
			}
		}
	}
}

### EVERYTHING RELATING TO THROWING A TEA PARTY

# Decide -- forest, or friends
character_event = {
	id = TEA.20000
	desc = search_for_tea_leaves_event_desc
	picture = GFX_evt_relaxed_ruler
	is_triggered_only = yes

	immediate = {
		character_event = { id = TEA.20001 } # remove all flags/variables relating to the tea party event chain.
	}

	option = {
		name = search_for_tea_leaves_forest_option
		custom_tooltip = {
			text = search_for_tea_leaves_forest_option_tooltip
		}
		character_event = { id = TEA.21000 days = 7 }
	}
	
	option = {
		name = search_for_tea_leaves_friends_option
		custom_tooltip = {
			text = search_for_tea_leaves_friends_option_tooltip
		}
		character_event = { id = TEA.22000 days = 7 }
	}
}

#CLEAR ALL TEA FLAGS
character_event = {
	id = TEA.20001
	is_triggered_only = yes
	hide_window = yes
	
	option = {
		set_variable = { which = tea_quality value = 0 }
		clr_character_flag = found_white_jade
		clr_character_flag = found_badger_spirit
		clr_character_flag = found_physician
		clr_character_flag = found_early_guest
		
		clr_character_flag = can_make_green_tea
		clr_character_flag = can_make_white_dragon
		clr_character_flag = can_make_jasmine_tea
		clr_character_flag = can_make_ginger_root_tea
		
		clr_character_flag = has_bacui_berries
		clr_character_flag = has_hotspring_water
		
		clr_character_flag = has_biscuits
		clr_character_flag = has_extra_guests
		
		clr_character_flag = badger_visitor
		clr_character_flag = physician_visitor
	}
}

# search forest -- start
character_event = {
	id = TEA.21000
	is_triggered_only = yes
	hide_window = yes

	option = {
		if = {
			limit = {
				has_character_flag = tea_chose_spirits
			}
			change_variable = { which = local_remaining_events value = 4 }
		}
		else = {
			change_variable = { which = local_remaining_events value = 3 }
		}
		character_event = { id = TEA.21001 } # start forest search roulette
	}
}

character_event = {
	id = TEA.21001
	is_triggered_only = yes
	hide_window = yes

	option = {
		if = {
			limit = {
				check_variable = { which = local_remaining_events value == 0 }
			}
			if = {
				limit = {
					OR = {
						has_character_flag = can_make_green_tea
						has_character_flag = can_make_white_dragon
					}
				}
				character_event = { id = TEA.21006 days = 3 }
			}
			else = {
				character_event = { id = TEA.21007 days = 3 }
			}
		}
		else = {
			subtract_variable = { which = local_remaining_events value = 1 }
			random_list = {
				30 = { 
					modifier = { factor = 1.5 NOT = { learning = 10 } }
					modifier = { factor = 0.5 learning = 12 }
					character_event = { id = TEA.21002 days = 3 }
				}
				20 = { 
					modifier = { factor = 0.5 learning = 14 }
					character_event = { id = TEA.21003 days = 5 }
				}
				10 = {
					modifier = { factor = 1.5 learning = 16}
					modifier = { factor = 0.0 has_character_flag = found_white_jade}
					set_character_flag = found_white_jade
					character_event = { id = TEA.21004 days = 14 }
				}
				5 = {
					modifier = { factor = 1.5 learning = 18}
					modifier = { factor = 0.5 NOT = { learning = 10 } }
					modifier = { factor = 0.0 has_character_flag = found_badger_spirit}
					set_character_flag = found_badger_spirit
					character_event = { id = TEA.21005 days = 14 }
				}
			}
		}
	}
}

character_event = {
	id = TEA.21002
	desc = forest_scrounge_desc
	picture = GFX_evt_mysterious_forest
	is_triggered_only = yes

	option = {
		name = forest_scrounge_option_bad
		random_list = {
			50 = { 
				custom_tooltip = {
					text = improves_tea_quality_random_list_tooltip
					hidden_tooltip = {
						change_variable = { which = tea_quality value = 1 }
					}
				}
			}
			50 = { 
				custom_tooltip = {
					text = decreases_tea_quality_random_list_tooltip
					hidden_tooltip = {
						subtract_variable = { which = tea_quality value = 1 }
					}
				}
			}
		}
		character_event = { id = TEA.21001 days = 7 }
	}
	
	option = {
		name = forest_scrounge_option_good
		
		trigger = {
			learning = 14
		}
		
		tooltip_info = learning
		
		custom_tooltip = {
			text = green_tea_tooltip
			hidden_tooltip = {
				set_character_flag = can_make_green_tea
			}
		}
		custom_tooltip = {
			text = improves_tea_quality_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 1 }
			}
		}
		character_event = { id = TEA.21001 days = 7 }
	}
}

character_event = {
	id = TEA.21003
	desc = collect_berries_desc
	picture = GFX_evt_mysterious_forest
	is_triggered_only = yes

	option = {
		name = collect_berries_do_collect
		custom_tooltip = {
			text = berries_tooltip
			hidden_tooltip = {
				set_character_flag = has_bacui_berries
			}
		}
		custom_tooltip = {
			text = improves_tea_quality_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 1 }
			}
		}
		character_event = { id = TEA.21001 days = 7 }
	}
	
	option = {
		name = collect_berries_no_collect
		custom_tooltip = {
			text = green_tea_tooltip
			hidden_tooltip = {
				set_character_flag = can_make_green_tea
			}
		}
		character_event = { id = TEA.21001 days = 7 }
	}
}

character_event = {
	id = TEA.21004
	desc = white_jade_found_desc
	picture = GFX_evt_mysterious_forest
	is_triggered_only = yes

	option = {
		name = white_jade_found_bad
		custom_tooltip = {
			text = white_jade_randomness_tooltip
			hidden_tooltip = {
				random_list = {
					50 = { 
						change_variable = { which = tea_quality value = 2 }
						set_character_flag = can_make_white_dragon
					}
					50 = { 
						subtract_variable = { which = tea_quality value = 5 }
					}
				}
			}
		}
		character_event = { id = TEA.21001 days = 7 }
	}
	
	option = {
		name = white_jade_found_safe
		
		trigger = {
			learning = 14
		}
		
		tooltip_info = learning
		
		custom_tooltip = {
			text = white_jade_identify_tooltip
			hidden_tooltip = {
				random_list = {
					50 = { 
						character_event = { id = TEA.21014 }
					}
					50 = {
						character_event = { id = TEA.21024 }
					}
				}
			}
		}
		character_event = { id = TEA.21001 days = 7 }
	}
	
	option = {
		name = white_jade_found_ignore
		character_event = { id = TEA.21001 days = 7 }
	}
}

character_event = {
	id = TEA.21014
	desc = white_jade_found_safe_success_desc
	picture = GFX_evt_mysterious_forest
	is_triggered_only = yes

	option = {
		name = white_jade_found_safe_success_option
		custom_tooltip = {
			text = white_jade_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 6 }
				set_character_flag = can_make_white_dragon
			}
		}
	}
}

character_event = {
	id = TEA.21024
	desc = white_jade_found_safe_fail_desc
	picture = GFX_evt_mysterious_forest
	is_triggered_only = yes

	option = {
		name = white_jade_found_safe_fail_option
	}
}

character_event = {
	id = TEA.21005
	desc = badger_spirit_start_desc
	picture = GFX_evt_mysterious_forest
	is_triggered_only = yes

	option = {
		name = badger_spirit_start_join
		
		trigger = {
			has_character_flag = tea_chose_spirits
		}
		
		custom_tooltip = {
			text = path_of_spirits_tooltip
		}
		
		character_event = { id = TEA.21015 }
		character_event = { id = TEA.21001 days = 7 }
	}
	
	option = {
		name = badger_spirit_start_wait
		character_event = { id = TEA.21001 days = 7 }
	}
}

character_event = {
	id = TEA.21015
	desc = badger_spirit_join_desc
	picture = GFX_evt_mysterious_forest
	is_triggered_only = yes

	option = {
		name = badger_spirit_join_option
		custom_tooltip = {
			text = green_tea_tooltip
			hidden_tooltip = {
				set_character_flag = can_make_green_tea
				random_list = {
					50 = {}
					50 = { set_character_flag = badger_visitor }
				}
			}
		}
		
		custom_tooltip = {
			text = improves_tea_quality_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 6 }
			}
		}
	}
}

character_event = {
	id = TEA.21025
	desc = badger_spirit_wait_desc
	picture = GFX_evt_mysterious_forest
	is_triggered_only = yes

	option = {
		name = badger_spirit_wait_hot_water
		
		custom_tooltip = {
			text = hotspring_tooltip
			hidden_tooltip = {
				set_character_flag = has_hotspring_water
			}
		}		
		
		custom_tooltip = {
			text = improves_tea_quality_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 1 }
			}
		}
	}
}

character_event = {
	id = TEA.21006
	desc = forest_tea_leaves_success_desc
	picture = GFX_evt_relaxed_ruler
	is_triggered_only = yes

	option = {
		name = forest_tea_leaves_success_green_tea
		
		trigger = {
			has_character_flag = can_make_green_tea
		}
		clr_character_flag = can_make_white_dragon		
	}
	
	option = {
		name = forest_tea_leaves_success_white_dragon
		
		trigger = {
			has_character_flag = can_make_white_dragon
		}
		clr_character_flag = can_make_green_tea
	}
	#pickle
}

character_event = {
	id = TEA.21007
	desc = forest_tea_leaves_fail_desc
	picture = GFX_evt_bad_news
	is_triggered_only = yes

	option = {
		name = forest_tea_leaves_fail_option
	}
#pickle
}

#ask friends start
# search forest -- start
character_event = {
	id = TEA.22000
	is_triggered_only = yes
	hide_window = yes

	option = {
		if = {
			limit = {
				has_character_flag = tea_chose_self
			}
			change_variable = { which = local_remaining_events value = 4 }
		}
		else = {
			change_variable = { which = local_remaining_events value = 3 }
		}
		character_event = { id = TEA.22001 } # start forest search roulette
	}
}

character_event = {
	id = TEA.22001
	is_triggered_only = yes
	hide_window = yes

	option = {
		if = {
			limit = {
				check_variable = { which = local_remaining_events value == 0 }
			}
			if = {
				limit = {
					OR = {
						has_character_flag = can_make_jasmine_tea
						has_character_flag = can_make_ginger_root_tea
					}
				}
				character_event = { id = TEA.22006 days = 3 }
			}
			else = {
				character_event = { id = TEA.22007 days = 3 }
			}
		}
		else = {
			subtract_variable = { which = local_remaining_events value = 1 }
			random_list = {
				30 = {
					modifier = { factor = 2.0 has_character_flag = tea_chose_spirits}
					modifier = { factor = 1.25 NOT = {diplomacy = 10 } }
					character_event = { id = TEA.22002 days = 3 }
				}
				20 = {
					modifier = { factor = 0.5 NOT = {diplomacy = 10 } }
					modifier = { factor = 1.5 has_character_flag = tea_chose_self}
					character_event = { id = TEA.22003 days = 5 }
				}
				10 = {
					modifier = { factor = 0 has_character_flag = found_early_stranger }
					modifier = { factor = 0.5 NOT = {diplomacy = 10 } }					
					set_character_flag = found_early_stranger
					character_event = { id = TEA.22004 days = 14 }
				}
				5 = {
					modifier = { factor = 0 has_character_flag = found_physician }
					modifier = { factor = 1.25 diplomacy = 16}
					modifier = { factor = 1.25 diplomacy = 12}
					modifier = { factor = 0.25 NOT = {diplomacy = 10 } }
					set_character_flag = found_physician
					character_event = { id = TEA.22005 days = 14 }
				}
			}
		}
	}
}

character_event = {
	id = TEA.22002
	desc = beg_friends_desc
	picture = GFX_evt_market
	is_triggered_only = yes

	option = {
		name = beg_friends_bad
		random_list = {
			50 = { 
				custom_tooltip = {
					text = improves_tea_quality_random_list_tooltip
					hidden_tooltip = {
						change_variable = { which = tea_quality value = 1 }
					}
				}
			}
			50 = { 
				custom_tooltip = {
					text = decreases_tea_quality_random_list_tooltip
					hidden_tooltip = {
						subtract_variable = { which = tea_quality value = 1 }
					}
				}
			}
		}
		character_event = { id = TEA.22001 days = 7 }
	}
	
	option = {
		name = beg_friends_good
		
		trigger = {
			diplomacy = 14
		}
		
		tooltip_info = diplomacy

		custom_tooltip = {
			text = jasmine_tea_tooltip
			hidden_tooltip = {
				set_character_flag = can_make_jasmine_tea
			}
		}
		custom_tooltip = {
			text = improves_tea_quality_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 1 }
			}
		}
		character_event = { id = TEA.22001 days = 7 }
	}
}

character_event = {
	id = TEA.22003
	desc = invite_extra_guests_desc
	picture = GFX_evt_market
	is_triggered_only = yes

	option = {
		name = invite_extra_guests_rumors
		prestige = 100
		custom_tooltip = {
			text = extra_guests_tooltip
			hidden_tooltip = {
				set_character_flag = has_extra_guests
			}
		}
		custom_tooltip = {
			text = improves_tea_quality_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 1 }
			}
		}
		character_event = { id = TEA.22001 days = 7 }
	}
	
	option = {
		name = invite_extra_guests_leaves
		custom_tooltip = {
			text = jasmine_tea_tooltip
			hidden_tooltip = {
				set_character_flag = can_make_jasmine_tea
			}
		}
		character_event = { id = TEA.22001 days = 7 }
	}
}

character_event = {
	id = TEA.22003
	desc = early_guest_start_desc
	picture = GFX_evt_feast
	is_triggered_only = yes	

	option = {
		name = early_guest_start_bad
		character_event = { id = TEA.22013 days = 7 }
		character_event = { id = TEA.22001 days = 7 }
	}
	
	option = {
		name = early_guest_start_good
	
		tooltip_info = diplomacy
	
		trigger = {
			diplomacy = 14
		}
		
		character_event = { id = TEA.22023 days = 7 }
		character_event = { id = TEA.22001 days = 7 }
	}
}

character_event = {
	id = TEA.22013
	desc = early_guest_no_party_desc
	picture = GFX_evt_feast
	is_triggered_only = yes	
	
	option = {
		name = early_guest_no_party_bad
		custom_tooltip = {
			text = decreases_tea_quality_tooltip
			hidden_tooltip = {
				subtract_variable = { which = tea_quality value = 1 }
			}
		}
	}
	
	option = {
		name = early_guest_no_party_good

		tooltip_info = diplomacy
	
		trigger = {
			diplomacy = 12
		}
		
		character_event = { id = TEA.22113 days = 7 }
	}
}

character_event = {
	id = TEA.22113
	desc = early_guest_recovery_desc
	picture = GFX_evt_feast
	is_triggered_only = yes	
	
	option = {
		name = early_guest_recovery_option
		custom_tooltip = {
			text = biscuits_tooltip
			hidden_tooltip = {
				set_character_flag = has_biscuits
			}
		}
		custom_tooltip = {
			text = improves_tea_quality_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 1 }
			}
		}
	}
}

character_event = {
	id = TEA.22023
	desc = early_guest_planning_desc
	picture = GFX_evt_feast
	is_triggered_only = yes	
	
	option = {
		name = early_guest_planning_biscuits
		prestige = 25
		custom_tooltip = {
			text = biscuits_tooltip
			hidden_tooltip = {
				set_character_flag = has_biscuits
			}
		}
		custom_tooltip = {
			text = improves_tea_quality_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 1 }
			}
		}
	}
	
	option = {
		name = invite_extra_guests_leaves
		custom_tooltip = {
			text = jasmine_tea_tooltip
			hidden_tooltip = {
				set_character_flag = can_make_jasmine_tea
			}
		}
	}
}

character_event = {
	id = TEA.22005
	desc = find_physician_desc
	picture = GFX_evt_market
	is_triggered_only = yes

	option = {
		name = find_physician_continue
		character_event = { id = TEA.22015 }
		character_event = { id = TEA.22001 days = 7 }
	}
	
	option = {
		name = find_physician_ignore
		character_event = { id = TEA.22025 }
		character_event = { id = TEA.22001 days = 7 }
	}
	
}

character_event = {
	id = TEA.22015
	desc = find_physician_meeting_desc
	picture = GFX_evt_market
	is_triggered_only = yes

	option = {
		name = find_physician_meeting_bad
		character_event = { id = TEA.22115 }
	}
	
	option = {
		name = find_physician_meeting_medium
		
		trigger = {
			has_character_flag = tea_chose_self
			NOT = { diplomacy = 14 }
		}
		
		custom_tooltip = {
			text = path_of_self_tooltip
		}
		character_event = { id = TEA.22215 }
	}
	
	option = {
		name = find_physician_meeting_good
		
		trigger = {
			has_character_flag = tea_chose_self
			diplomacy = 16
		}
		
		tooltip_info = diplomacy
		
		custom_tooltip = {
			text = path_of_self_tooltip
		}
		
		character_event = { id = TEA.22315 }
	}
}

character_event = {
	id = TEA.22115
	desc = find_physician_meeting_bad_desc
	picture = GFX_evt_market
	is_triggered_only = yes
	
	option = {
		name = find_physician_meeting_bad
		custom_tooltip = {
			text = decreases_tea_quality_tooltip
			hidden_tooltip = {
				subtract_variable = { which = tea_quality value = 1 }
			}
		}
	}
}

character_event = {
	id = TEA.22215
	desc = find_physician_meeting_medium_desc
	picture = GFX_evt_market
	is_triggered_only = yes
	
	option = {
		name = find_physician_meeting_medium_good_option
		custom_tooltip = {
			text = ginger_root_tea_tooltip
			hidden_tooltip = {
				set_character_flag = can_make_ginger_root_tea
			}
		}
		custom_tooltip = {
			text = improves_tea_quality_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 1 }
			}
		}
	}
}

character_event = {
	id = TEA.22315
	desc = find_physician_meeting_good_desc
	picture = GFX_evt_market
	is_triggered_only = yes
	
	option = {
		name = find_physician_meeting_medium_good_option
		custom_tooltip = {
			text = ginger_root_tea_tooltip
			hidden_tooltip = {
				set_character_flag = can_make_ginger_root_tea
			}
		}
		custom_tooltip = {
			text = improves_tea_quality_tooltip
			hidden_tooltip = {
				change_variable = { which = tea_quality value = 2 }
			}
		}
		hidden_tooltip = {
			random_list = {
				50 = { }
				50 = { set_character_flag = physician_visitor }
			}
		}
	}
}

character_event = {
	id = TEA.22025
	desc = find_physician_market_desc
	picture = GFX_evt_market
	is_triggered_only = yes

	option = {
		name = find_physician_market_option
		wealth = -10
		random_list = {
			50 = { 
				custom_tooltip = {
					text = improves_tea_quality_random_list_tooltip
					hidden_tooltip = {
						change_variable = { which = tea_quality value = 1 }
					}
				}
			}
			50 = { 
				custom_tooltip = {
					text = decreases_tea_quality_random_list_tooltip
					hidden_tooltip = {
						subtract_variable = { which = tea_quality value = 1 }
					}
				}
			}
		}
	}
}

character_event = {
	id = TEA.22006
	desc = ask_friends_success_desc
	picture = GFX_evt_relaxed_ruler
	is_triggered_only = yes

	option = {
		name = ask_friends_success_jasmine_tea
		
		trigger = {
			has_character_flag = can_make_jasmine_tea
		}
		clr_character_flag = can_make_ginger_root_tea	
	}
	
	option = {
		name = ask_friends_success_ginger_root_tea
		
		trigger = {
			has_character_flag = can_make_ginger_root_tea
		}
		clr_character_flag = can_make_jasmine_tea
	}
	#pickle
}

character_event = {
	id = TEA.22007
	desc = ask_friends_fail_desc
	picture = GFX_evt_bad_news
	is_triggered_only = yes

	option = {
		name = ask_friends_fail_option
	}
#pickle
}

#22025
#GFX_evt_mysterious_forest
#GFX_evt_market
#GFX_evt_feast
#GFX_evt_dancing